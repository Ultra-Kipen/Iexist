{"version":3,"names":["_getJestObj","mock","useNavigation","goBack","jest","fn","useRoute","params","challengeId","getChallengeDetails","mockGetChallengeDetails","apply","arguments","participateInChallenge","mockParticipateInChallenge","leaveChallenge","mockLeaveChallenge","updateChallengeProgress","mockUpdateChallengeProgress","getAllEmotions","mockGetAllEmotions","_interopRequireDefault","require","_asyncToGenerator2","_react","_reactNative","_reactNative2","_ChallengeDetailScreen","_jsxRuntime","_require","spyOn","Alert","mockImplementation","describe","mockChallenge","data","challenge_id","title","description","start_date","end_date","is_public","max_participants","participant_count","creator","user_id","username","nickname","is_participating","created_at","participants","profile_image_url","progress_entries","mockEmotions","emotion_id","name","icon","color","beforeEach","clearAllMocks","mockResolvedValue","success","it","default","_render","render","jsx","getByText","expect","toBeTruthy","_render2","waitFor","toHaveBeenCalledTimes","timeout","mockRejectedValueOnce","Error","_render3","_render4","fireEvent","press","toHaveBeenCalledWith","alert","mockResolvedValueOnce","Object","assign","_render5"],"sources":["ChallengeDetailScreen.test.tsx"],"sourcesContent":["// __tests__/screens/ChallengeDetailScreen.test.tsx\r\nimport React from 'react';\r\nimport { render, act, fireEvent, waitFor } from '@testing-library/react-native';\r\nimport { Alert } from 'react-native';\r\nimport ChallengeDetailScreen from '../../src/screens/ChallengeDetailScreen';\r\n\r\n// 필요한 모듈 모킹\r\njest.mock('@react-navigation/native', () => ({\r\n  useNavigation: () => ({\r\n    goBack: jest.fn(),\r\n  }),\r\n  useRoute: () => ({\r\n    params: { challengeId: 1 },\r\n  }),\r\n}));\r\n\r\n// 서비스 모킹\r\nconst mockGetChallengeDetails = jest.fn();\r\nconst mockParticipateInChallenge = jest.fn();\r\nconst mockLeaveChallenge = jest.fn();\r\nconst mockUpdateChallengeProgress = jest.fn();\r\nconst mockGetAllEmotions = jest.fn();\r\n\r\njest.mock('../../src/services/api/challengeService', () => ({\r\n  getChallengeDetails: (...args: any) => mockGetChallengeDetails(...args),\r\n  participateInChallenge: (...args: any) => mockParticipateInChallenge(...args),\r\n  leaveChallenge: (...args: any) => mockLeaveChallenge(...args),\r\n  updateChallengeProgress: (...args: any) => mockUpdateChallengeProgress(...args),\r\n}));\r\n\r\njest.mock('../../src/services/api/emotionService', () => ({\r\n  getAllEmotions: (...args: any) => mockGetAllEmotions(...args),\r\n}));\r\n\r\n// DOM 컴포넌트는 직접 모킹하지 않고, 실제 렌더링된 요소를 검색하는 방식으로 변경\r\n\r\n// Alert.alert 모킹\r\njest.spyOn(Alert, 'alert').mockImplementation(() => {});\r\n\r\ndescribe('ChallengeDetailScreen', () => {\r\n  // 기본 응답 데이터 준비\r\n  const mockChallenge = {\r\n    data: {\r\n      data: {\r\n        challenge_id: 1,\r\n        title: '7일간의 감사 일기',\r\n        description: '매일 감사한 일 3가지를 기록해보세요.',\r\n        start_date: '2025-04-01',\r\n        end_date: '2025-04-30',\r\n        is_public: true,\r\n        max_participants: null,\r\n        participant_count: 10,\r\n        creator: {\r\n          user_id: 1,\r\n          username: 'creator',\r\n          nickname: 'Creator',\r\n        },\r\n        is_participating: false,\r\n        created_at: '2025-03-25T00:00:00.000Z',\r\n        participants: [\r\n          {\r\n            user_id: 2,\r\n            username: 'user1',\r\n            nickname: 'User1',\r\n            profile_image_url: null,\r\n          },\r\n        ],\r\n        progress_entries: [],\r\n      }\r\n    }\r\n  };\r\n\r\n  const mockEmotions = {\r\n    data: {\r\n      data: [\r\n        { emotion_id: 1, name: '행복', icon: 'emoticon-happy-outline', color: '#FFD700' },\r\n        { emotion_id: 2, name: '감사', icon: 'hand-heart', color: '#FF69B4' },\r\n      ]\r\n    }\r\n  };\r\n\r\n  beforeEach(() => {\r\n    jest.clearAllMocks();\r\n    \r\n    // 기본 모킹 설정\r\n    mockGetChallengeDetails.mockResolvedValue(mockChallenge);\r\n    mockGetAllEmotions.mockResolvedValue(mockEmotions);\r\n    mockParticipateInChallenge.mockResolvedValue({ data: { success: true } });\r\n    mockLeaveChallenge.mockResolvedValue({ data: { success: true } });\r\n    mockUpdateChallengeProgress.mockResolvedValue({ data: { success: true } });\r\n  });\r\n\r\n  it('renders loading state initially', async () => {\r\n    const { getByText } = render(<ChallengeDetailScreen />);\r\n    expect(getByText('챌린지 정보 로딩 중...')).toBeTruthy();\r\n  }, 30000);\r\n\r\n  it('renders challenge details correctly', async () => {\r\n    const { getByText } = render(<ChallengeDetailScreen />);\r\n    \r\n    // 데이터 로딩이 완료될 때까지 대기\r\n    await waitFor(() => expect(mockGetChallengeDetails).toHaveBeenCalledTimes(1), { timeout: 5000 });\r\n    \r\n    // 비동기 작업 완료 후 UI 업데이트 대기\r\n    await waitFor(() => expect(getByText('7일간의 감사 일기')).toBeTruthy(), { timeout: 5000 });\r\n    expect(getByText('매일 감사한 일 3가지를 기록해보세요.')).toBeTruthy();\r\n    expect(getByText('챌린지 참여하기')).toBeTruthy();\r\n  }, 30000);\r\n\r\n  it('handles error state', async () => {\r\n    mockGetChallengeDetails.mockRejectedValueOnce(new Error('API 오류'));\r\n    \r\n    const { getByText } = render(<ChallengeDetailScreen />);\r\n    \r\n    // 에러 상태가 표시될 때까지 대기\r\n    await waitFor(() => expect(mockGetChallengeDetails).toHaveBeenCalledTimes(1), { timeout: 5000 });\r\n    await waitFor(() => expect(getByText('챌린지 정보를 불러오는 중 오류가 발생했습니다.')).toBeTruthy(), { timeout: 5000 });\r\n    expect(getByText('다시 시도')).toBeTruthy();\r\n  }, 30000);\r\n\r\n  it('handles participation toggle', async () => {\r\n    const { getByText } = render(<ChallengeDetailScreen />);\r\n    \r\n    // 데이터 로딩이 완료될 때까지 대기\r\n    await waitFor(() => expect(mockGetChallengeDetails).toHaveBeenCalledTimes(1), { timeout: 5000 });\r\n    \r\n    // 참여 버튼이 렌더링될 때까지 대기\r\n    await waitFor(() => expect(getByText('챌린지 참여하기')).toBeTruthy(), { timeout: 5000 });\r\n    \r\n    // 참여 버튼 클릭\r\n    fireEvent.press(getByText('챌린지 참여하기'));\r\n    \r\n    // API 호출 확인\r\n    await waitFor(() => expect(mockParticipateInChallenge).toHaveBeenCalledWith(1), { timeout: 5000 });\r\n    expect(Alert.alert).toHaveBeenCalledWith('성공', '챌린지에 참여했습니다.');\r\n  }, 30000);\r\n\r\n// __tests__/screens/ChallengeDetailScreen.test.tsx - progress submission 테스트 부분 수정\r\n\r\nit('renders the record emotion button when participating', async () => {\r\n    // 참여 중인 챌린지로 설정\r\n    mockGetChallengeDetails.mockResolvedValueOnce({\r\n      data: {\r\n        data: {\r\n          ...mockChallenge.data.data,\r\n          is_participating: true\r\n        }\r\n      }\r\n    });\r\n    \r\n    const { getByText } = render(<ChallengeDetailScreen />);\r\n    \r\n    // 화면이 로드되고 참여 중인 상태의 UI가 표시될 때까지 대기\r\n    await waitFor(() => expect(getByText('챌린지 나가기')).toBeTruthy(), { timeout: 5000 });\r\n    \r\n    // 감정 기록 관련 UI 요소들이 표시되는지 확인\r\n    expect(getByText('오늘의 감정 기록')).toBeTruthy();\r\n    expect(getByText('감정 기록하기')).toBeTruthy();\r\n  }, 30000);\r\n});"],"mappings":"AAOAA,WAAA,GAAKC,IAAI,CAAC,0BAA0B,EAAE;EAAA,OAAO;IAC3CC,aAAa,EAAE,SAAfA,aAAaA,CAAA;MAAA,OAAS;QACpBC,MAAM,EAAEC,IAAI,CAACC,EAAE,CAAC;MAClB,CAAC;IAAA,CAAC;IACFC,QAAQ,EAAE,SAAVA,QAAQA,CAAA;MAAA,OAAS;QACfC,MAAM,EAAE;UAAEC,WAAW,EAAE;QAAE;MAC3B,CAAC;IAAA;EACH,CAAC;AAAA,CAAC,CAAC;AASHR,WAAA,GAAKC,IAAI,CAAC,yCAAyC,EAAE;EAAA,OAAO;IAC1DQ,mBAAmB,EAAE,SAArBA,mBAAmBA,CAAA;MAAA,OAAoBC,uBAAuB,CAAAC,KAAA,SAAAC,SAAQ,CAAC;IAAA;IACvEC,sBAAsB,EAAE,SAAxBA,sBAAsBA,CAAA;MAAA,OAAoBC,0BAA0B,CAAAH,KAAA,SAAAC,SAAQ,CAAC;IAAA;IAC7EG,cAAc,EAAE,SAAhBA,cAAcA,CAAA;MAAA,OAAoBC,kBAAkB,CAAAL,KAAA,SAAAC,SAAQ,CAAC;IAAA;IAC7DK,uBAAuB,EAAE,SAAzBA,uBAAuBA,CAAA;MAAA,OAAoBC,2BAA2B,CAAAP,KAAA,SAAAC,SAAQ,CAAC;IAAA;EACjF,CAAC;AAAA,CAAC,CAAC;AAEHZ,WAAA,GAAKC,IAAI,CAAC,uCAAuC,EAAE;EAAA,OAAO;IACxDkB,cAAc,EAAE,SAAhBA,cAAcA,CAAA;MAAA,OAAoBC,kBAAkB,CAAAT,KAAA,SAAAC,SAAQ,CAAC;IAAA;EAC/D,CAAC;AAAA,CAAC,CAAC;AAAC,IAAAS,sBAAA,GAAAC,OAAA;AAAA,IAAAC,kBAAA,GAAAF,sBAAA,CAAAC,OAAA;AA/BJ,IAAAE,MAAA,GAAAH,sBAAA,CAAAC,OAAA;AACA,IAAAG,YAAA,GAAAH,OAAA;AACA,IAAAI,aAAA,GAAAJ,OAAA;AACA,IAAAK,sBAAA,GAAAN,sBAAA,CAAAC,OAAA;AAA4E,IAAAM,WAAA,GAAAN,OAAA;AAAA,SAAAtB,YAAA;EAAA,IAAA6B,QAAA,GAAAP,OAAA;IAAAlB,IAAA,GAAAyB,QAAA,CAAAzB,IAAA;EAAAJ,WAAA,YAAAA,YAAA;IAAA,OAAAI,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AAa5E,IAAMM,uBAAuB,GAAGN,IAAI,CAACC,EAAE,CAAC,CAAC;AACzC,IAAMS,0BAA0B,GAAGV,IAAI,CAACC,EAAE,CAAC,CAAC;AAC5C,IAAMW,kBAAkB,GAAGZ,IAAI,CAACC,EAAE,CAAC,CAAC;AACpC,IAAMa,2BAA2B,GAAGd,IAAI,CAACC,EAAE,CAAC,CAAC;AAC7C,IAAMe,kBAAkB,GAAGhB,IAAI,CAACC,EAAE,CAAC,CAAC;AAgBpCD,IAAI,CAAC0B,KAAK,CAACC,mBAAK,EAAE,OAAO,CAAC,CAACC,kBAAkB,CAAC,YAAM,CAAC,CAAC,CAAC;AAEvDC,QAAQ,CAAC,uBAAuB,EAAE,YAAM;EAEtC,IAAMC,aAAa,GAAG;IACpBC,IAAI,EAAE;MACJA,IAAI,EAAE;QACJC,YAAY,EAAE,CAAC;QACfC,KAAK,EAAE,YAAY;QACnBC,WAAW,EAAE,uBAAuB;QACpCC,UAAU,EAAE,YAAY;QACxBC,QAAQ,EAAE,YAAY;QACtBC,SAAS,EAAE,IAAI;QACfC,gBAAgB,EAAE,IAAI;QACtBC,iBAAiB,EAAE,EAAE;QACrBC,OAAO,EAAE;UACPC,OAAO,EAAE,CAAC;UACVC,QAAQ,EAAE,SAAS;UACnBC,QAAQ,EAAE;QACZ,CAAC;QACDC,gBAAgB,EAAE,KAAK;QACvBC,UAAU,EAAE,0BAA0B;QACtCC,YAAY,EAAE,CACZ;UACEL,OAAO,EAAE,CAAC;UACVC,QAAQ,EAAE,OAAO;UACjBC,QAAQ,EAAE,OAAO;UACjBI,iBAAiB,EAAE;QACrB,CAAC,CACF;QACDC,gBAAgB,EAAE;MACpB;IACF;EACF,CAAC;EAED,IAAMC,YAAY,GAAG;IACnBlB,IAAI,EAAE;MACJA,IAAI,EAAE,CACJ;QAAEmB,UAAU,EAAE,CAAC;QAAEC,IAAI,EAAE,IAAI;QAAEC,IAAI,EAAE,wBAAwB;QAAEC,KAAK,EAAE;MAAU,CAAC,EAC/E;QAAEH,UAAU,EAAE,CAAC;QAAEC,IAAI,EAAE,IAAI;QAAEC,IAAI,EAAE,YAAY;QAAEC,KAAK,EAAE;MAAU,CAAC;IAEvE;EACF,CAAC;EAEDC,UAAU,CAAC,YAAM;IACftD,IAAI,CAACuD,aAAa,CAAC,CAAC;IAGpBjD,uBAAuB,CAACkD,iBAAiB,CAAC1B,aAAa,CAAC;IACxDd,kBAAkB,CAACwC,iBAAiB,CAACP,YAAY,CAAC;IAClDvC,0BAA0B,CAAC8C,iBAAiB,CAAC;MAAEzB,IAAI,EAAE;QAAE0B,OAAO,EAAE;MAAK;IAAE,CAAC,CAAC;IACzE7C,kBAAkB,CAAC4C,iBAAiB,CAAC;MAAEzB,IAAI,EAAE;QAAE0B,OAAO,EAAE;MAAK;IAAE,CAAC,CAAC;IACjE3C,2BAA2B,CAAC0C,iBAAiB,CAAC;MAAEzB,IAAI,EAAE;QAAE0B,OAAO,EAAE;MAAK;IAAE,CAAC,CAAC;EAC5E,CAAC,CAAC;EAEFC,EAAE,CAAC,iCAAiC,MAAAvC,kBAAA,CAAAwC,OAAA,EAAE,aAAY;IAChD,IAAAC,OAAA,GAAsB,IAAAC,mBAAM,EAAC,IAAArC,WAAA,CAAAsC,GAAA,EAACvC,sBAAA,CAAAoC,OAAqB,IAAE,CAAC,CAAC;MAA/CI,SAAS,GAAAH,OAAA,CAATG,SAAS;IACjBC,MAAM,CAACD,SAAS,CAAC,gBAAgB,CAAC,CAAC,CAACE,UAAU,CAAC,CAAC;EAClD,CAAC,GAAE,KAAK,CAAC;EAETP,EAAE,CAAC,qCAAqC,MAAAvC,kBAAA,CAAAwC,OAAA,EAAE,aAAY;IACpD,IAAAO,QAAA,GAAsB,IAAAL,mBAAM,EAAC,IAAArC,WAAA,CAAAsC,GAAA,EAACvC,sBAAA,CAAAoC,OAAqB,IAAE,CAAC,CAAC;MAA/CI,SAAS,GAAAG,QAAA,CAATH,SAAS;IAGjB,MAAM,IAAAI,oBAAO,EAAC;MAAA,OAAMH,MAAM,CAAC1D,uBAAuB,CAAC,CAAC8D,qBAAqB,CAAC,CAAC,CAAC;IAAA,GAAE;MAAEC,OAAO,EAAE;IAAK,CAAC,CAAC;IAGhG,MAAM,IAAAF,oBAAO,EAAC;MAAA,OAAMH,MAAM,CAACD,SAAS,CAAC,YAAY,CAAC,CAAC,CAACE,UAAU,CAAC,CAAC;IAAA,GAAE;MAAEI,OAAO,EAAE;IAAK,CAAC,CAAC;IACpFL,MAAM,CAACD,SAAS,CAAC,uBAAuB,CAAC,CAAC,CAACE,UAAU,CAAC,CAAC;IACvDD,MAAM,CAACD,SAAS,CAAC,UAAU,CAAC,CAAC,CAACE,UAAU,CAAC,CAAC;EAC5C,CAAC,GAAE,KAAK,CAAC;EAETP,EAAE,CAAC,qBAAqB,MAAAvC,kBAAA,CAAAwC,OAAA,EAAE,aAAY;IACpCrD,uBAAuB,CAACgE,qBAAqB,CAAC,IAAIC,KAAK,CAAC,QAAQ,CAAC,CAAC;IAElE,IAAAC,QAAA,GAAsB,IAAAX,mBAAM,EAAC,IAAArC,WAAA,CAAAsC,GAAA,EAACvC,sBAAA,CAAAoC,OAAqB,IAAE,CAAC,CAAC;MAA/CI,SAAS,GAAAS,QAAA,CAATT,SAAS;IAGjB,MAAM,IAAAI,oBAAO,EAAC;MAAA,OAAMH,MAAM,CAAC1D,uBAAuB,CAAC,CAAC8D,qBAAqB,CAAC,CAAC,CAAC;IAAA,GAAE;MAAEC,OAAO,EAAE;IAAK,CAAC,CAAC;IAChG,MAAM,IAAAF,oBAAO,EAAC;MAAA,OAAMH,MAAM,CAACD,SAAS,CAAC,4BAA4B,CAAC,CAAC,CAACE,UAAU,CAAC,CAAC;IAAA,GAAE;MAAEI,OAAO,EAAE;IAAK,CAAC,CAAC;IACpGL,MAAM,CAACD,SAAS,CAAC,OAAO,CAAC,CAAC,CAACE,UAAU,CAAC,CAAC;EACzC,CAAC,GAAE,KAAK,CAAC;EAETP,EAAE,CAAC,8BAA8B,MAAAvC,kBAAA,CAAAwC,OAAA,EAAE,aAAY;IAC7C,IAAAc,QAAA,GAAsB,IAAAZ,mBAAM,EAAC,IAAArC,WAAA,CAAAsC,GAAA,EAACvC,sBAAA,CAAAoC,OAAqB,IAAE,CAAC,CAAC;MAA/CI,SAAS,GAAAU,QAAA,CAATV,SAAS;IAGjB,MAAM,IAAAI,oBAAO,EAAC;MAAA,OAAMH,MAAM,CAAC1D,uBAAuB,CAAC,CAAC8D,qBAAqB,CAAC,CAAC,CAAC;IAAA,GAAE;MAAEC,OAAO,EAAE;IAAK,CAAC,CAAC;IAGhG,MAAM,IAAAF,oBAAO,EAAC;MAAA,OAAMH,MAAM,CAACD,SAAS,CAAC,UAAU,CAAC,CAAC,CAACE,UAAU,CAAC,CAAC;IAAA,GAAE;MAAEI,OAAO,EAAE;IAAK,CAAC,CAAC;IAGlFK,sBAAS,CAACC,KAAK,CAACZ,SAAS,CAAC,UAAU,CAAC,CAAC;IAGtC,MAAM,IAAAI,oBAAO,EAAC;MAAA,OAAMH,MAAM,CAACtD,0BAA0B,CAAC,CAACkE,oBAAoB,CAAC,CAAC,CAAC;IAAA,GAAE;MAAEP,OAAO,EAAE;IAAK,CAAC,CAAC;IAClGL,MAAM,CAACrC,mBAAK,CAACkD,KAAK,CAAC,CAACD,oBAAoB,CAAC,IAAI,EAAE,cAAc,CAAC;EAChE,CAAC,GAAE,KAAK,CAAC;EAIXlB,EAAE,CAAC,sDAAsD,MAAAvC,kBAAA,CAAAwC,OAAA,EAAE,aAAY;IAEnErD,uBAAuB,CAACwE,qBAAqB,CAAC;MAC5C/C,IAAI,EAAE;QACJA,IAAI,EAAAgD,MAAA,CAAAC,MAAA,KACClD,aAAa,CAACC,IAAI,CAACA,IAAI;UAC1Ba,gBAAgB,EAAE;QAAI;MAE1B;IACF,CAAC,CAAC;IAEF,IAAAqC,QAAA,GAAsB,IAAApB,mBAAM,EAAC,IAAArC,WAAA,CAAAsC,GAAA,EAACvC,sBAAA,CAAAoC,OAAqB,IAAE,CAAC,CAAC;MAA/CI,SAAS,GAAAkB,QAAA,CAATlB,SAAS;IAGjB,MAAM,IAAAI,oBAAO,EAAC;MAAA,OAAMH,MAAM,CAACD,SAAS,CAAC,SAAS,CAAC,CAAC,CAACE,UAAU,CAAC,CAAC;IAAA,GAAE;MAAEI,OAAO,EAAE;IAAK,CAAC,CAAC;IAGjFL,MAAM,CAACD,SAAS,CAAC,WAAW,CAAC,CAAC,CAACE,UAAU,CAAC,CAAC;IAC3CD,MAAM,CAACD,SAAS,CAAC,SAAS,CAAC,CAAC,CAACE,UAAU,CAAC,CAAC;EAC3C,CAAC,GAAE,KAAK,CAAC;AACX,CAAC,CAAC","ignoreList":[]}