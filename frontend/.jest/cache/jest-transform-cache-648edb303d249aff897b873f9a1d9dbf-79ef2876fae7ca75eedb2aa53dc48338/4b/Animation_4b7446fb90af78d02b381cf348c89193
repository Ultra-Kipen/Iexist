7db5e6f9e5c33df5ef999d9d74f41245
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _toConsumableArray2 = _interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
var _classPrivateFieldLooseBase2 = _interopRequireDefault(require("@babel/runtime/helpers/classPrivateFieldLooseBase"));
var _classPrivateFieldLooseKey2 = _interopRequireDefault(require("@babel/runtime/helpers/classPrivateFieldLooseKey"));
var _NativeAnimatedHelper = _interopRequireDefault(require("../../../src/private/animated/NativeAnimatedHelper"));
var ReactNativeFeatureFlags = _interopRequireWildcard(require("../../../src/private/featureflags/ReactNativeFeatureFlags"));
var _AnimatedProps = _interopRequireDefault(require("../nodes/AnimatedProps"));
function _getRequireWildcardCache(e) { if ("function" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(e) { return e ? t : r; })(e); }
function _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || "object" != typeof e && "function" != typeof e) return { default: e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if ("default" !== u && {}.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n.default = e, t && t.set(e, n), n; }
var startNativeAnimationNextId = 1;
var _nativeID = (0, _classPrivateFieldLooseKey2.default)("nativeID");
var _onEnd = (0, _classPrivateFieldLooseKey2.default)("onEnd");
var _useNativeDriver = (0, _classPrivateFieldLooseKey2.default)("useNativeDriver");
var Animation = exports.default = function () {
  function Animation(config) {
    var _config$isInteraction, _config$iterations;
    (0, _classCallCheck2.default)(this, Animation);
    Object.defineProperty(this, _nativeID, {
      writable: true,
      value: void 0
    });
    Object.defineProperty(this, _onEnd, {
      writable: true,
      value: void 0
    });
    Object.defineProperty(this, _useNativeDriver, {
      writable: true,
      value: void 0
    });
    (0, _classPrivateFieldLooseBase2.default)(this, _useNativeDriver)[_useNativeDriver] = _NativeAnimatedHelper.default.shouldUseNativeDriver(config);
    this.__active = false;
    this.__isInteraction = (_config$isInteraction = config.isInteraction) != null ? _config$isInteraction : !(0, _classPrivateFieldLooseBase2.default)(this, _useNativeDriver)[_useNativeDriver];
    this.__isLooping = config.isLooping;
    this.__iterations = (_config$iterations = config.iterations) != null ? _config$iterations : 1;
    if (true) {
      this.__debugID = config.debugID;
    }
  }
  return (0, _createClass2.default)(Animation, [{
    key: "start",
    value: function start(fromValue, onUpdate, onEnd, previousAnimation, animatedValue) {
      if (!(0, _classPrivateFieldLooseBase2.default)(this, _useNativeDriver)[_useNativeDriver] && animatedValue.__isNative === true) {
        throw new Error('Attempting to run JS driven animation on animated node ' + 'that has been moved to "native" earlier by starting an ' + 'animation with `useNativeDriver: true`');
      }
      (0, _classPrivateFieldLooseBase2.default)(this, _onEnd)[_onEnd] = onEnd;
      this.__active = true;
    }
  }, {
    key: "stop",
    value: function stop() {
      if ((0, _classPrivateFieldLooseBase2.default)(this, _nativeID)[_nativeID] != null) {
        var nativeID = (0, _classPrivateFieldLooseBase2.default)(this, _nativeID)[_nativeID];
        var identifier = `${nativeID}:stopAnimation`;
        try {
          _NativeAnimatedHelper.default.API.setWaitingForIdentifier(identifier);
          _NativeAnimatedHelper.default.API.stopAnimation(nativeID);
        } finally {
          _NativeAnimatedHelper.default.API.unsetWaitingForIdentifier(identifier);
        }
      }
      this.__active = false;
    }
  }, {
    key: "__getNativeAnimationConfig",
    value: function __getNativeAnimationConfig() {
      throw new Error('This animation type cannot be offloaded to native');
    }
  }, {
    key: "__findAnimatedPropsNodes",
    value: function __findAnimatedPropsNodes(node) {
      var result = [];
      if (node instanceof _AnimatedProps.default) {
        result.push(node);
        return result;
      }
      for (var child of node.__getChildren()) {
        result.push.apply(result, (0, _toConsumableArray2.default)(this.__findAnimatedPropsNodes(child)));
      }
      return result;
    }
  }, {
    key: "__startAnimationIfNative",
    value: function __startAnimationIfNative(animatedValue) {
      var _this = this;
      if (!(0, _classPrivateFieldLooseBase2.default)(this, _useNativeDriver)[_useNativeDriver]) {
        return false;
      }
      var startNativeAnimationWaitId = `${startNativeAnimationNextId}:startAnimation`;
      startNativeAnimationNextId += 1;
      _NativeAnimatedHelper.default.API.setWaitingForIdentifier(startNativeAnimationWaitId);
      try {
        var config = this.__getNativeAnimationConfig();
        animatedValue.__makeNative(config.platformConfig);
        (0, _classPrivateFieldLooseBase2.default)(this, _nativeID)[_nativeID] = _NativeAnimatedHelper.default.generateNewAnimationId();
        _NativeAnimatedHelper.default.API.startAnimatingNode((0, _classPrivateFieldLooseBase2.default)(this, _nativeID)[_nativeID], animatedValue.__getNativeTag(), config, function (result) {
          _this.__notifyAnimationEnd(result);
          var value = result.value;
          if (value != null) {
            animatedValue.__onAnimatedValueUpdateReceived(value);
            if (ReactNativeFeatureFlags.shouldSkipStateUpdatesForLoopingAnimations() && _this.__isLooping === true) {
              return;
            }
            _this.__findAnimatedPropsNodes(animatedValue).forEach(function (node) {
              return node.update();
            });
          }
        });
        return true;
      } catch (e) {
        throw e;
      } finally {
        _NativeAnimatedHelper.default.API.unsetWaitingForIdentifier(startNativeAnimationWaitId);
      }
    }
  }, {
    key: "__notifyAnimationEnd",
    value: function __notifyAnimationEnd(result) {
      var callback = (0, _classPrivateFieldLooseBase2.default)(this, _onEnd)[_onEnd];
      if (callback != null) {
        (0, _classPrivateFieldLooseBase2.default)(this, _onEnd)[_onEnd] = null;
        callback(result);
      }
    }
  }, {
    key: "__getDebugID",
    value: function __getDebugID() {
      if (true) {
        return this.__debugID;
      }
      return undefined;
    }
  }]);
}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfTmF0aXZlQW5pbWF0ZWRIZWxwZXIiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIlJlYWN0TmF0aXZlRmVhdHVyZUZsYWdzIiwiX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQiLCJfQW5pbWF0ZWRQcm9wcyIsIl9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZSIsImUiLCJXZWFrTWFwIiwiciIsInQiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsImhhcyIsImdldCIsIm4iLCJfX3Byb3RvX18iLCJhIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJ1IiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiaSIsInNldCIsInN0YXJ0TmF0aXZlQW5pbWF0aW9uTmV4dElkIiwiX25hdGl2ZUlEIiwiX2NsYXNzUHJpdmF0ZUZpZWxkTG9vc2VLZXkyIiwiX29uRW5kIiwiX3VzZU5hdGl2ZURyaXZlciIsIkFuaW1hdGlvbiIsImV4cG9ydHMiLCJjb25maWciLCJfY29uZmlnJGlzSW50ZXJhY3Rpb24iLCJfY29uZmlnJGl0ZXJhdGlvbnMiLCJfY2xhc3NDYWxsQ2hlY2syIiwid3JpdGFibGUiLCJ2YWx1ZSIsIl9jbGFzc1ByaXZhdGVGaWVsZExvb3NlQmFzZTIiLCJOYXRpdmVBbmltYXRlZEhlbHBlciIsInNob3VsZFVzZU5hdGl2ZURyaXZlciIsIl9fYWN0aXZlIiwiX19pc0ludGVyYWN0aW9uIiwiaXNJbnRlcmFjdGlvbiIsIl9faXNMb29waW5nIiwiaXNMb29waW5nIiwiX19pdGVyYXRpb25zIiwiaXRlcmF0aW9ucyIsIl9fZGVidWdJRCIsImRlYnVnSUQiLCJfY3JlYXRlQ2xhc3MyIiwia2V5Iiwic3RhcnQiLCJmcm9tVmFsdWUiLCJvblVwZGF0ZSIsIm9uRW5kIiwicHJldmlvdXNBbmltYXRpb24iLCJhbmltYXRlZFZhbHVlIiwiX19pc05hdGl2ZSIsIkVycm9yIiwic3RvcCIsIm5hdGl2ZUlEIiwiaWRlbnRpZmllciIsIkFQSSIsInNldFdhaXRpbmdGb3JJZGVudGlmaWVyIiwic3RvcEFuaW1hdGlvbiIsInVuc2V0V2FpdGluZ0ZvcklkZW50aWZpZXIiLCJfX2dldE5hdGl2ZUFuaW1hdGlvbkNvbmZpZyIsIl9fZmluZEFuaW1hdGVkUHJvcHNOb2RlcyIsIm5vZGUiLCJyZXN1bHQiLCJBbmltYXRlZFByb3BzIiwicHVzaCIsImNoaWxkIiwiX19nZXRDaGlsZHJlbiIsImFwcGx5IiwiX3RvQ29uc3VtYWJsZUFycmF5MiIsIl9fc3RhcnRBbmltYXRpb25JZk5hdGl2ZSIsIl90aGlzIiwic3RhcnROYXRpdmVBbmltYXRpb25XYWl0SWQiLCJfX21ha2VOYXRpdmUiLCJwbGF0Zm9ybUNvbmZpZyIsImdlbmVyYXRlTmV3QW5pbWF0aW9uSWQiLCJzdGFydEFuaW1hdGluZ05vZGUiLCJfX2dldE5hdGl2ZVRhZyIsIl9fbm90aWZ5QW5pbWF0aW9uRW5kIiwiX19vbkFuaW1hdGVkVmFsdWVVcGRhdGVSZWNlaXZlZCIsInNob3VsZFNraXBTdGF0ZVVwZGF0ZXNGb3JMb29waW5nQW5pbWF0aW9ucyIsImZvckVhY2giLCJ1cGRhdGUiLCJjYWxsYmFjayIsIl9fZ2V0RGVidWdJRCIsInVuZGVmaW5lZCJdLCJzb3VyY2VzIjpbIkFuaW1hdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgTWV0YSBQbGF0Zm9ybXMsIEluYy4gYW5kIGFmZmlsaWF0ZXMuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKlxuICogQGZsb3cgc3RyaWN0LWxvY2FsXG4gKiBAZm9ybWF0XG4gKi9cblxuaW1wb3J0IHR5cGUge1BsYXRmb3JtQ29uZmlnfSBmcm9tICcuLi9BbmltYXRlZFBsYXRmb3JtQ29uZmlnJztcbmltcG9ydCB0eXBlIEFuaW1hdGVkTm9kZSBmcm9tICcuLi9ub2Rlcy9BbmltYXRlZE5vZGUnO1xuaW1wb3J0IHR5cGUgQW5pbWF0ZWRWYWx1ZSBmcm9tICcuLi9ub2Rlcy9BbmltYXRlZFZhbHVlJztcblxuaW1wb3J0IE5hdGl2ZUFuaW1hdGVkSGVscGVyIGZyb20gJy4uLy4uLy4uL3NyYy9wcml2YXRlL2FuaW1hdGVkL05hdGl2ZUFuaW1hdGVkSGVscGVyJztcbmltcG9ydCAqIGFzIFJlYWN0TmF0aXZlRmVhdHVyZUZsYWdzIGZyb20gJy4uLy4uLy4uL3NyYy9wcml2YXRlL2ZlYXR1cmVmbGFncy9SZWFjdE5hdGl2ZUZlYXR1cmVGbGFncyc7XG5pbXBvcnQgQW5pbWF0ZWRQcm9wcyBmcm9tICcuLi9ub2Rlcy9BbmltYXRlZFByb3BzJztcblxuZXhwb3J0IHR5cGUgRW5kUmVzdWx0ID0ge2ZpbmlzaGVkOiBib29sZWFuLCB2YWx1ZT86IG51bWJlciwgLi4ufTtcbmV4cG9ydCB0eXBlIEVuZENhbGxiYWNrID0gKHJlc3VsdDogRW5kUmVzdWx0KSA9PiB2b2lkO1xuXG5leHBvcnQgdHlwZSBBbmltYXRpb25Db25maWcgPSAkUmVhZE9ubHk8e1xuICBpc0ludGVyYWN0aW9uPzogYm9vbGVhbixcbiAgdXNlTmF0aXZlRHJpdmVyOiBib29sZWFuLFxuICBwbGF0Zm9ybUNvbmZpZz86IFBsYXRmb3JtQ29uZmlnLFxuICBvbkNvbXBsZXRlPzogP0VuZENhbGxiYWNrLFxuICBpdGVyYXRpb25zPzogbnVtYmVyLFxuICBpc0xvb3Bpbmc/OiBib29sZWFuLFxuICBkZWJ1Z0lEPzogP3N0cmluZyxcbiAgLi4uXG59PjtcblxubGV0IHN0YXJ0TmF0aXZlQW5pbWF0aW9uTmV4dElkID0gMTtcblxuLy8gSW1wb3J0YW50IG5vdGU6IHN0YXJ0KCkgYW5kIHN0b3AoKSB3aWxsIG9ubHkgYmUgY2FsbGVkIGF0IG1vc3Qgb25jZS5cbi8vIE9uY2UgYW4gYW5pbWF0aW9uIGhhcyBiZWVuIHN0b3BwZWQgb3IgZmluaXNoZWQgaXRzIGNvdXJzZSwgaXQgd2lsbFxuLy8gbm90IGJlIHJldXNlZC5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFuaW1hdGlvbiB7XG4gICNuYXRpdmVJRDogP251bWJlcjtcbiAgI29uRW5kOiA/RW5kQ2FsbGJhY2s7XG4gICN1c2VOYXRpdmVEcml2ZXI6IGJvb2xlYW47XG5cbiAgX19hY3RpdmU6IGJvb2xlYW47XG4gIF9faXNJbnRlcmFjdGlvbjogYm9vbGVhbjtcbiAgX19pc0xvb3Bpbmc6ID9ib29sZWFuO1xuICBfX2l0ZXJhdGlvbnM6IG51bWJlcjtcbiAgX19kZWJ1Z0lEOiA/c3RyaW5nO1xuXG4gIGNvbnN0cnVjdG9yKGNvbmZpZzogQW5pbWF0aW9uQ29uZmlnKSB7XG4gICAgdGhpcy4jdXNlTmF0aXZlRHJpdmVyID0gTmF0aXZlQW5pbWF0ZWRIZWxwZXIuc2hvdWxkVXNlTmF0aXZlRHJpdmVyKGNvbmZpZyk7XG5cbiAgICB0aGlzLl9fYWN0aXZlID0gZmFsc2U7XG4gICAgdGhpcy5fX2lzSW50ZXJhY3Rpb24gPSBjb25maWcuaXNJbnRlcmFjdGlvbiA/PyAhdGhpcy4jdXNlTmF0aXZlRHJpdmVyO1xuICAgIHRoaXMuX19pc0xvb3BpbmcgPSBjb25maWcuaXNMb29waW5nO1xuICAgIHRoaXMuX19pdGVyYXRpb25zID0gY29uZmlnLml0ZXJhdGlvbnMgPz8gMTtcbiAgICBpZiAoX19ERVZfXykge1xuICAgICAgdGhpcy5fX2RlYnVnSUQgPSBjb25maWcuZGVidWdJRDtcbiAgICB9XG4gIH1cblxuICBzdGFydChcbiAgICBmcm9tVmFsdWU6IG51bWJlcixcbiAgICBvblVwZGF0ZTogKHZhbHVlOiBudW1iZXIpID0+IHZvaWQsXG4gICAgb25FbmQ6ID9FbmRDYWxsYmFjayxcbiAgICBwcmV2aW91c0FuaW1hdGlvbjogP0FuaW1hdGlvbixcbiAgICBhbmltYXRlZFZhbHVlOiBBbmltYXRlZFZhbHVlLFxuICApOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuI3VzZU5hdGl2ZURyaXZlciAmJiBhbmltYXRlZFZhbHVlLl9faXNOYXRpdmUgPT09IHRydWUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgJ0F0dGVtcHRpbmcgdG8gcnVuIEpTIGRyaXZlbiBhbmltYXRpb24gb24gYW5pbWF0ZWQgbm9kZSAnICtcbiAgICAgICAgICAndGhhdCBoYXMgYmVlbiBtb3ZlZCB0byBcIm5hdGl2ZVwiIGVhcmxpZXIgYnkgc3RhcnRpbmcgYW4gJyArXG4gICAgICAgICAgJ2FuaW1hdGlvbiB3aXRoIGB1c2VOYXRpdmVEcml2ZXI6IHRydWVgJyxcbiAgICAgICk7XG4gICAgfVxuXG4gICAgdGhpcy4jb25FbmQgPSBvbkVuZDtcbiAgICB0aGlzLl9fYWN0aXZlID0gdHJ1ZTtcbiAgfVxuXG4gIHN0b3AoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuI25hdGl2ZUlEICE9IG51bGwpIHtcbiAgICAgIGNvbnN0IG5hdGl2ZUlEID0gdGhpcy4jbmF0aXZlSUQ7XG4gICAgICBjb25zdCBpZGVudGlmaWVyID0gYCR7bmF0aXZlSUR9OnN0b3BBbmltYXRpb25gO1xuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gVGhpcyBpcyBvbmx5IHJlcXVpcmVkIHdoZW4gc2luZ2xlT3BCYXRjaGluZyBpcyB1c2VkLCBhcyBvdGhlcndpc2VcbiAgICAgICAgLy8gd2UgZmx1c2ggY2FsbHMgaW1tZWRpYXRlbHkgd2hlbiB0aGVyZSdzIG5vIHBlbmRpbmcgcXVldWUuXG4gICAgICAgIE5hdGl2ZUFuaW1hdGVkSGVscGVyLkFQSS5zZXRXYWl0aW5nRm9ySWRlbnRpZmllcihpZGVudGlmaWVyKTtcbiAgICAgICAgTmF0aXZlQW5pbWF0ZWRIZWxwZXIuQVBJLnN0b3BBbmltYXRpb24obmF0aXZlSUQpO1xuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgTmF0aXZlQW5pbWF0ZWRIZWxwZXIuQVBJLnVuc2V0V2FpdGluZ0ZvcklkZW50aWZpZXIoaWRlbnRpZmllcik7XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMuX19hY3RpdmUgPSBmYWxzZTtcbiAgfVxuXG4gIF9fZ2V0TmF0aXZlQW5pbWF0aW9uQ29uZmlnKCk6ICRSZWFkT25seTx7XG4gICAgcGxhdGZvcm1Db25maWc6ID9QbGF0Zm9ybUNvbmZpZyxcbiAgICAuLi5cbiAgfT4ge1xuICAgIC8vIFN1YmNsYXNzZXMgdGhhdCBoYXZlIGNvcnJlc3BvbmRpbmcgYW5pbWF0aW9uIGltcGxlbWVudGF0aW9uIGRvbmUgaW4gbmF0aXZlXG4gICAgLy8gc2hvdWxkIG92ZXJyaWRlIHRoaXMgbWV0aG9kXG4gICAgdGhyb3cgbmV3IEVycm9yKCdUaGlzIGFuaW1hdGlvbiB0eXBlIGNhbm5vdCBiZSBvZmZsb2FkZWQgdG8gbmF0aXZlJyk7XG4gIH1cblxuICBfX2ZpbmRBbmltYXRlZFByb3BzTm9kZXMobm9kZTogQW5pbWF0ZWROb2RlKTogQXJyYXk8QW5pbWF0ZWRQcm9wcz4ge1xuICAgIGNvbnN0IHJlc3VsdCA9IFtdO1xuXG4gICAgaWYgKG5vZGUgaW5zdGFuY2VvZiBBbmltYXRlZFByb3BzKSB7XG4gICAgICByZXN1bHQucHVzaChub2RlKTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgZm9yIChjb25zdCBjaGlsZCBvZiBub2RlLl9fZ2V0Q2hpbGRyZW4oKSkge1xuICAgICAgcmVzdWx0LnB1c2goLi4udGhpcy5fX2ZpbmRBbmltYXRlZFByb3BzTm9kZXMoY2hpbGQpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgX19zdGFydEFuaW1hdGlvbklmTmF0aXZlKGFuaW1hdGVkVmFsdWU6IEFuaW1hdGVkVmFsdWUpOiBib29sZWFuIHtcbiAgICBpZiAoIXRoaXMuI3VzZU5hdGl2ZURyaXZlcikge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGNvbnN0IHN0YXJ0TmF0aXZlQW5pbWF0aW9uV2FpdElkID0gYCR7c3RhcnROYXRpdmVBbmltYXRpb25OZXh0SWR9OnN0YXJ0QW5pbWF0aW9uYDtcbiAgICBzdGFydE5hdGl2ZUFuaW1hdGlvbk5leHRJZCArPSAxO1xuICAgIE5hdGl2ZUFuaW1hdGVkSGVscGVyLkFQSS5zZXRXYWl0aW5nRm9ySWRlbnRpZmllcihcbiAgICAgIHN0YXJ0TmF0aXZlQW5pbWF0aW9uV2FpdElkLFxuICAgICk7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGNvbmZpZyA9IHRoaXMuX19nZXROYXRpdmVBbmltYXRpb25Db25maWcoKTtcbiAgICAgIGFuaW1hdGVkVmFsdWUuX19tYWtlTmF0aXZlKGNvbmZpZy5wbGF0Zm9ybUNvbmZpZyk7XG4gICAgICB0aGlzLiNuYXRpdmVJRCA9IE5hdGl2ZUFuaW1hdGVkSGVscGVyLmdlbmVyYXRlTmV3QW5pbWF0aW9uSWQoKTtcbiAgICAgIE5hdGl2ZUFuaW1hdGVkSGVscGVyLkFQSS5zdGFydEFuaW1hdGluZ05vZGUoXG4gICAgICAgIHRoaXMuI25hdGl2ZUlELFxuICAgICAgICBhbmltYXRlZFZhbHVlLl9fZ2V0TmF0aXZlVGFnKCksXG4gICAgICAgIGNvbmZpZyxcbiAgICAgICAgcmVzdWx0ID0+IHtcbiAgICAgICAgICB0aGlzLl9fbm90aWZ5QW5pbWF0aW9uRW5kKHJlc3VsdCk7XG5cbiAgICAgICAgICAvLyBXaGVuIHVzaW5nIG5hdGl2ZWx5IGRyaXZlbiBhbmltYXRpb25zLCBvbmNlIHRoZSBhbmltYXRpb24gY29tcGxldGVzLFxuICAgICAgICAgIC8vIHdlIG5lZWQgdG8gZW5zdXJlIHRoYXQgdGhlIEpTIHNpZGUgbm9kZXMgYXJlIHN5bmNlZCB3aXRoIHRoZSB1cGRhdGVkXG4gICAgICAgICAgLy8gdmFsdWVzLlxuICAgICAgICAgIGNvbnN0IHt2YWx1ZX0gPSByZXN1bHQ7XG4gICAgICAgICAgaWYgKHZhbHVlICE9IG51bGwpIHtcbiAgICAgICAgICAgIGFuaW1hdGVkVmFsdWUuX19vbkFuaW1hdGVkVmFsdWVVcGRhdGVSZWNlaXZlZCh2YWx1ZSk7XG5cbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgUmVhY3ROYXRpdmVGZWF0dXJlRmxhZ3Muc2hvdWxkU2tpcFN0YXRlVXBkYXRlc0Zvckxvb3BpbmdBbmltYXRpb25zKCkgJiZcbiAgICAgICAgICAgICAgdGhpcy5fX2lzTG9vcGluZyA9PT0gdHJ1ZVxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gT25jZSB0aGUgSlMgc2lkZSBub2RlIGlzIHN5bmNlZCB3aXRoIHRoZSB1cGRhdGVkIHZhbHVlcywgdHJpZ2dlciBhblxuICAgICAgICAgICAgLy8gdXBkYXRlIG9uIHRoZSBBbmltYXRlZFByb3BzIG5vZGVzIHRvIGNhbGwgYW55IHJlZ2lzdGVyZWQgY2FsbGJhY2tzLlxuICAgICAgICAgICAgdGhpcy5fX2ZpbmRBbmltYXRlZFByb3BzTm9kZXMoYW5pbWF0ZWRWYWx1ZSkuZm9yRWFjaChub2RlID0+XG4gICAgICAgICAgICAgIG5vZGUudXBkYXRlKCksXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICk7XG5cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHRocm93IGU7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIE5hdGl2ZUFuaW1hdGVkSGVscGVyLkFQSS51bnNldFdhaXRpbmdGb3JJZGVudGlmaWVyKFxuICAgICAgICBzdGFydE5hdGl2ZUFuaW1hdGlvbldhaXRJZCxcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIE5vdGlmeSB0aGUgY29tcGxldGlvbiBjYWxsYmFjayB0aGF0IHRoZSBhbmltYXRpb24gaGFzIGVuZGVkLiBUaGUgY29tcGxldGlvblxuICAgKiBjYWxsYmFjayB3aWxsIG5ldmVyIGJlIGNhbGxlZCBtb3JlIHRoYW4gb25jZS5cbiAgICovXG4gIF9fbm90aWZ5QW5pbWF0aW9uRW5kKHJlc3VsdDogRW5kUmVzdWx0KTogdm9pZCB7XG4gICAgY29uc3QgY2FsbGJhY2sgPSB0aGlzLiNvbkVuZDtcbiAgICBpZiAoY2FsbGJhY2sgIT0gbnVsbCkge1xuICAgICAgdGhpcy4jb25FbmQgPSBudWxsO1xuICAgICAgY2FsbGJhY2socmVzdWx0KTtcbiAgICB9XG4gIH1cblxuICBfX2dldERlYnVnSUQoKTogP3N0cmluZyB7XG4gICAgaWYgKF9fREVWX18pIHtcbiAgICAgIHJldHVybiB0aGlzLl9fZGVidWdJRDtcbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBY0EsSUFBQUEscUJBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLHVCQUFBLEdBQUFDLHVCQUFBLENBQUFGLE9BQUE7QUFDQSxJQUFBRyxjQUFBLEdBQUFKLHNCQUFBLENBQUFDLE9BQUE7QUFBbUQsU0FBQUkseUJBQUFDLENBQUEsNkJBQUFDLE9BQUEsbUJBQUFDLENBQUEsT0FBQUQsT0FBQSxJQUFBRSxDQUFBLE9BQUFGLE9BQUEsWUFBQUYsd0JBQUEsWUFBQUEseUJBQUFDLENBQUEsV0FBQUEsQ0FBQSxHQUFBRyxDQUFBLEdBQUFELENBQUEsS0FBQUYsQ0FBQTtBQUFBLFNBQUFILHdCQUFBRyxDQUFBLEVBQUFFLENBQUEsU0FBQUEsQ0FBQSxJQUFBRixDQUFBLElBQUFBLENBQUEsQ0FBQUksVUFBQSxTQUFBSixDQUFBLGVBQUFBLENBQUEsdUJBQUFBLENBQUEseUJBQUFBLENBQUEsV0FBQUssT0FBQSxFQUFBTCxDQUFBLFFBQUFHLENBQUEsR0FBQUosd0JBQUEsQ0FBQUcsQ0FBQSxPQUFBQyxDQUFBLElBQUFBLENBQUEsQ0FBQUcsR0FBQSxDQUFBTixDQUFBLFVBQUFHLENBQUEsQ0FBQUksR0FBQSxDQUFBUCxDQUFBLE9BQUFRLENBQUEsS0FBQUMsU0FBQSxVQUFBQyxDQUFBLEdBQUFDLE1BQUEsQ0FBQUMsY0FBQSxJQUFBRCxNQUFBLENBQUFFLHdCQUFBLFdBQUFDLENBQUEsSUFBQWQsQ0FBQSxvQkFBQWMsQ0FBQSxPQUFBQyxjQUFBLENBQUFDLElBQUEsQ0FBQWhCLENB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