{"version":3,"names":["_prettyFormat","_interopRequireWildcard","require","_mapProps","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","formatElement","element","_ref","arguments","length","undefined","compact","_ref$highlight","highlight","_ref$mapProps","mapProps","defaultMapProps","_element$props","props","children","_objectWithoutProperties2","_excluded","childrenToDisplay","$$typeof","Symbol","for","type","plugins","ReactTestComponent","ReactElement","printFunctionName","printBasicPrototype","min","formatElementList","elements","options","map","join","formatJson","json","_ref2","_ref2$highlight","_ref2$mapProps","getElementJsonPlugin","test","val","serialize","config","indentation","depth","refs","printer","newVal","assign"],"sources":["../../src/helpers/format-element.ts"],"sourcesContent":["import type { ReactTestInstance, ReactTestRendererJSON } from 'react-test-renderer';\nimport type { NewPlugin } from 'pretty-format';\nimport prettyFormat, { plugins } from 'pretty-format';\n\nimport type { MapPropsFunction } from './map-props';\nimport { defaultMapProps } from './map-props';\n\nexport type FormatElementOptions = {\n  /** Minimize used space. */\n  compact?: boolean;\n\n  /** Highlight the output. */\n  highlight?: boolean;\n\n  /** Filter or map props to display. */\n  mapProps?: MapPropsFunction | null;\n};\n\n/***\n * Format given element as a pretty-printed string.\n *\n * @param element Element to format.\n */\nexport function formatElement(\n  element: ReactTestInstance | null,\n  { compact, highlight = true, mapProps = defaultMapProps }: FormatElementOptions = {},\n) {\n  if (element == null) {\n    return '(null)';\n  }\n\n  const { children, ...props } = element.props;\n  const childrenToDisplay = typeof children === 'string' ? [children] : undefined;\n\n  return prettyFormat(\n    {\n      // This prop is needed persuade the prettyFormat that the element is\n      // a ReactTestRendererJSON instance, so it is formatted as JSX.\n      $$typeof: Symbol.for('react.test.json'),\n      type: `${element.type}`,\n      props: mapProps ? mapProps(props) : props,\n      children: childrenToDisplay,\n    },\n    // See: https://www.npmjs.com/package/pretty-format#usage-with-options\n    {\n      plugins: [plugins.ReactTestComponent, plugins.ReactElement],\n      printFunctionName: false,\n      printBasicPrototype: false,\n      highlight: highlight,\n      min: compact,\n    },\n  );\n}\n\nexport function formatElementList(elements: ReactTestInstance[], options?: FormatElementOptions) {\n  if (elements.length === 0) {\n    return '(no elements)';\n  }\n\n  return elements.map((element) => formatElement(element, options)).join('\\n');\n}\n\nexport function formatJson(\n  json: ReactTestRendererJSON | ReactTestRendererJSON[],\n  { compact, highlight = true, mapProps = defaultMapProps }: FormatElementOptions = {},\n) {\n  return prettyFormat(json, {\n    plugins: [getElementJsonPlugin(mapProps), plugins.ReactElement],\n    highlight: highlight,\n    printBasicPrototype: false,\n    min: compact,\n  });\n}\n\nfunction getElementJsonPlugin(mapProps?: MapPropsFunction | null): NewPlugin {\n  return {\n    test: (val) => plugins.ReactTestComponent.test(val),\n    serialize: (val, config, indentation, depth, refs, printer) => {\n      let newVal = val;\n      if (mapProps && val.props) {\n        newVal = { ...val, props: mapProps(val.props) };\n      }\n      return plugins.ReactTestComponent.serialize(\n        newVal,\n        config,\n        indentation,\n        depth,\n        refs,\n        printer,\n      );\n    },\n  };\n}\n"],"mappings":"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","ignoreList":[]}