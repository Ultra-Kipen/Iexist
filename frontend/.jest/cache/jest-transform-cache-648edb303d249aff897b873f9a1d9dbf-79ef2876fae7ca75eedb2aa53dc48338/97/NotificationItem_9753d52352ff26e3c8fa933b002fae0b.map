{"version":3,"names":["_react","_interopRequireDefault","require","_reactNative","_native","_NotificationContext","_MaterialCommunityIcons","_jsxRuntime","NotificationItem","_ref","notification","onPress","navigation","useNavigation","_useNotification","useNotification","markAsRead","deleteNotification","getIcon","notification_type","formattedTime","formatRelativeTime","created_at","handlePress","_ref2","_asyncToGenerator2","default","is_read","id","related_id","navigate","postId","challengeId","apply","arguments","confirmDelete","Alert","alert","text","style","jsxs","TouchableOpacity","testID","styles","container","unread","onLongPress","children","jsx","View","iconContainer","name","size","color","contentContainer","Text","content","time","unreadDot","dateString","now","Date","date","diffMs","getTime","diffMins","Math","floor","diffHours","diffDays","diffWeeks","diffMonths","diffYears","StyleSheet","create","flexDirection","padding","borderBottomWidth","borderBottomColor","backgroundColor","width","height","borderRadius","justifyContent","alignItems","marginRight","flex","fontSize","marginBottom","alignSelf","marginLeft","_default","exports"],"sources":["NotificationItem.tsx"],"sourcesContent":["import React from 'react';\r\nimport { View, Text, StyleSheet, TouchableOpacity, Alert } from 'react-native';\r\nimport { useNavigation } from '@react-navigation/native';\r\nimport { useNotification } from '../contexts/NotificationContext';\r\n\r\n// 아이콘 컴포넌트 - 실제 구현에 맞게 수정 필요\r\nimport Icon from 'react-native-vector-icons/MaterialCommunityIcons';\r\n\r\n// NotificationContext에서 정의된 타입 사용\r\ninterface Notification {\r\n  id: number;\r\n  user_id: number;\r\n  content: string;\r\n  notification_type: 'like' | 'comment' | 'challenge' | 'system';\r\n  related_id?: number;\r\n  is_read: boolean;\r\n  created_at: string;\r\n}\r\n\r\ninterface NotificationItemProps {\r\n  notification: Notification;\r\n  onPress?: () => void;\r\n}\r\n\r\nconst NotificationItem: React.FC<NotificationItemProps> = ({ notification, onPress }) => {\r\n  const navigation = useNavigation<any>(); // any 타입으로 변경\r\n  const { markAsRead, deleteNotification } = useNotification();\r\n  \r\n  // 알림 유형에 따른 아이콘 결정\r\n  const getIcon = () => {\r\n    switch (notification.notification_type) {\r\n      case 'like':\r\n        return 'heart-outline';\r\n      case 'comment':\r\n        return 'comment-outline';\r\n      case 'challenge':\r\n        return 'trophy-outline';\r\n      case 'system':\r\n        return 'bell-outline';\r\n      default:\r\n        return 'bell-outline';\r\n    }\r\n  };\r\n  \r\n  // 알림 시간 포맷팅 - 직접 구현으로 변경\r\n  const formattedTime = formatRelativeTime(notification.created_at);\r\n  \r\n // 알림 클릭 처리\r\n const handlePress = async () => {\r\n  // onPress 콜백을 먼저 호출\r\n  if (onPress) {\r\n    onPress();\r\n  }\r\n\r\n  if (!notification.is_read) {\r\n    await markAsRead(notification.id);\r\n  }\r\n  \r\n  // 알림 유형에 따라 다른 화면으로 이동\r\n  if (notification.related_id) {\r\n    switch (notification.notification_type) {\r\n      case 'like':\r\n      case 'comment':\r\n        navigation.navigate('PostDetailScreen', { postId: notification.related_id });\r\n        break;\r\n      case 'challenge':\r\n        navigation.navigate('ChallengeDetailScreen', { challengeId: notification.related_id });\r\n        break;\r\n    }\r\n  }\r\n};\r\n  // 알림 삭제 확인\r\n  const confirmDelete = () => {\r\n    Alert.alert(\r\n      '알림 삭제',\r\n      '이 알림을 삭제하시겠습니까?',\r\n      [\r\n        { text: '취소', style: 'cancel' },\r\n        { \r\n          text: '삭제', \r\n          onPress: () => deleteNotification(notification.id),\r\n          style: 'destructive'\r\n        }\r\n      ]\r\n    );\r\n  };\r\n  \r\n  return (\r\n    <TouchableOpacity\r\n      testID=\"notification-item\"\r\n      style={[\r\n        styles.container,\r\n        !notification.is_read && styles.unread\r\n      ]}\r\n      onPress={handlePress}\r\n      onLongPress={confirmDelete}\r\n    >\r\n      <View style={styles.iconContainer}>\r\n        <Icon name={getIcon()} size={24} color=\"#4A6572\" />\r\n      </View>\r\n      <View style={styles.contentContainer}>\r\n        <Text style={styles.content}>{notification.content}</Text>\r\n        <Text style={styles.time}>{formattedTime}</Text>\r\n      </View>\r\n      {!notification.is_read && <View testID=\"unread-indicator\" style={styles.unreadDot} />}\r\n    </TouchableOpacity>\r\n  );\r\n};\r\n\r\n// date-fns 대신 직접 포맷팅 함수 구현\r\nconst formatRelativeTime = (dateString: string): string => {\r\n  const now = new Date();\r\n  const date = new Date(dateString);\r\n  const diffMs = now.getTime() - date.getTime();\r\n  \r\n  // 분 단위 차이 계산\r\n  const diffMins = Math.floor(diffMs / (1000 * 60));\r\n  \r\n  if (diffMins < 1) return '방금 전';\r\n  if (diffMins < 60) return `${diffMins}분 전`;\r\n  \r\n  // 시간 단위 차이 계산\r\n  const diffHours = Math.floor(diffMins / 60);\r\n  if (diffHours < 24) return `${diffHours}시간 전`;\r\n  \r\n  // 일 단위 차이 계산\r\n  const diffDays = Math.floor(diffHours / 24);\r\n  if (diffDays < 7) return `${diffDays}일 전`;\r\n  \r\n  // 주 단위 차이 계산\r\n  const diffWeeks = Math.floor(diffDays / 7);\r\n  if (diffWeeks < 4) return `${diffWeeks}주 전`;\r\n  \r\n  // 월 단위 차이 계산\r\n  const diffMonths = Math.floor(diffDays / 30);\r\n  if (diffMonths < 12) return `${diffMonths}개월 전`;\r\n  \r\n  // 년 단위 차이 계산\r\n  const diffYears = Math.floor(diffDays / 365);\r\n  return `${diffYears}년 전`;\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flexDirection: 'row',\r\n    padding: 16,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: '#E1E8ED',\r\n    backgroundColor: 'white'\r\n  },\r\n  unread: {\r\n    backgroundColor: '#F5F8FA'\r\n  },\r\n  iconContainer: {\r\n    width: 40,\r\n    height: 40,\r\n    borderRadius: 20,\r\n    backgroundColor: '#E8EDF0',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    marginRight: 12\r\n  },\r\n  contentContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center'\r\n  },\r\n  content: {\r\n    fontSize: 14,\r\n    color: '#14171A',\r\n    marginBottom: 4\r\n  },\r\n  time: {\r\n    fontSize: 12,\r\n    color: '#657786'\r\n  },\r\n  unreadDot: {\r\n    width: 8,\r\n    height: 8,\r\n    borderRadius: 4,\r\n    backgroundColor: '#1DA1F2',\r\n    alignSelf: 'center',\r\n    marginLeft: 8\r\n  }\r\n});\r\n\r\nexport default NotificationItem;"],"mappings":"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","ignoreList":[]}