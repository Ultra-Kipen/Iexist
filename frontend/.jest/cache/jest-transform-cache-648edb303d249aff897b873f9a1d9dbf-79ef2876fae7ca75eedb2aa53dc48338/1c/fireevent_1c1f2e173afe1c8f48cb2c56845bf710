f83ed788d156b9ab0b023df63c6e9f96
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
exports.isEventEnabled = isEventEnabled;
exports.isTouchResponder = isTouchResponder;
var _act = _interopRequireDefault(require("./act"));
var _eventHandler = require("./event-handler");
var _componentTree = require("./helpers/component-tree");
var _hostComponentNames = require("./helpers/host-component-names");
var _pointerEvents = require("./helpers/pointer-events");
var _textInput = require("./helpers/text-input");
var _nativeState = require("./native-state");
function _interopRequireDefault(e) {
  return e && e.__esModule ? e : {
    default: e
  };
}
function isTouchResponder(element) {
  if (!(0, _componentTree.isHostElement)(element)) {
    return false;
  }
  return Boolean(element.props.onStartShouldSetResponder) || (0, _hostComponentNames.isHostTextInput)(element);
}
var eventsAffectedByPointerEventsProp = new Set(['press', 'onPress']);
var textInputEventsIgnoringEditableProp = new Set(['contentSizeChange', 'onContentSizeChange', 'layout', 'onLayout', 'scroll', 'onScroll']);
function isEventEnabled(element, eventName, nearestTouchResponder) {
  if (nearestTouchResponder != null && (0, _hostComponentNames.isHostTextInput)(nearestTouchResponder)) {
    return (0, _textInput.isEditableTextInput)(nearestTouchResponder) || textInputEventsIgnoringEditableProp.has(eventName);
  }
  if (eventsAffectedByPointerEventsProp.has(eventName) && !(0, _pointerEvents.isPointerEventEnabled)(element)) {
    return false;
  }
  var touchStart = nearestTouchResponder == null || nearestTouchResponder.props.onStartShouldSetResponder == null ? void 0 : nearestTouchResponder.props.onStartShouldSetResponder();
  var touchMove = nearestTouchResponder == null || nearestTouchResponder.props.onMoveShouldSetResponder == null ? void 0 : nearestTouchResponder.props.onMoveShouldSetResponder();
  if (touchStart || touchMove) {
    return true;
  }
  return touchStart === undefined && touchMove === undefined;
}
function findEventHandler(element, eventName, nearestTouchResponder) {
  var touchResponder = isTouchResponder(element) ? element : nearestTouchResponder;
  var handler = (0, _eventHandler.getEventHandler)(element, eventName, {
    loose: true
  });
  if (handler && isEventEnabled(element, eventName, touchResponder)) return handler;
  if (element.parent === null || element.parent.parent === null) {
    return null;
  }
  return findEventHandler(element.parent, eventName, touchResponder);
}
function fireEvent(element, eventName) {
  for (var _len = arguments.length, data = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {
    data[_key - 2] = arguments[_key];
  }
  if (!(0, _componentTree.isElementMounted)(element)) {
    return;
  }
  setNativeStateIfNeeded(element, eventName, data[0]);
  var handler = findEventHandler(element, eventName);
  if (!handler) {
    return;
  }
  var returnValue;
  void (0, _act.default)(function () {
    returnValue = handler.apply(void 0, data);
  });
  return returnValue;
}
fireEvent.press = function (element) {
  for (var _len2 = arguments.length, data = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {
    data[_key2 - 1] = arguments[_key2];
  }
  return fireEvent.apply(void 0, [element, 'press'].concat(data));
};
fireEvent.changeText = function (element) {
  for (var _len3 = arguments.length, data = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {
    data[_key3 - 1] = arguments[_key3];
  }
  return fireEvent.apply(void 0, [element, 'changeText'].concat(data));
};
fireEvent.scroll = function (element) {
  for (var _len4 = arguments.length, data = new Array(_len4 > 1 ? _len4 - 1 : 0), _key4 = 1; _key4 < _len4; _key4++) {
    data[_key4 - 1] = arguments[_key4];
  }
  return fireEvent.apply(void 0, [element, 'scroll'].concat(data));
};
var _default = exports.default = fireEvent;
var scrollEventNames = new Set(['scroll', 'scrollBeginDrag', 'scrollEndDrag', 'momentumScrollBegin', 'momentumScrollEnd']);
function setNativeStateIfNeeded(element, eventName, value) {
  if (eventName === 'changeText' && typeof value === 'string' && (0, _textInput.isEditableTextInput)(element)) {
    _nativeState.nativeState.valueForElement.set(element, value);
  }
  if (scrollEventNames.has(eventName) && (0, _hostComponentNames.isHostScrollView)(element)) {
    var contentOffset = tryGetContentOffset(value);
    if (contentOffset) {
      _nativeState.nativeState.contentOffsetForElement.set(element, contentOffset);
    }
  }
}
function tryGetContentOffset(event) {
  try {
    var _event$nativeEvent;
    var contentOffset = event == null || (_event$nativeEvent = event.nativeEvent) == null ? void 0 : _event$nativeEvent.contentOffset;
    var x = contentOffset == null ? void 0 : contentOffset.x;
    var y = contentOffset == null ? void 0 : contentOffset.y;
    if (typeof x === 'number' || typeof y === 'number') {
      return {
        x: Number.isFinite(x) ? x : 0,
        y: Number.isFinite(y) ? y : 0
      };
    }
  } catch (_unused) {}
  return null;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfYWN0IiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfZXZlbnRIYW5kbGVyIiwiX2NvbXBvbmVudFRyZWUiLCJfaG9zdENvbXBvbmVudE5hbWVzIiwiX3BvaW50ZXJFdmVudHMiLCJfdGV4dElucHV0IiwiX25hdGl2ZVN0YXRlIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiaXNUb3VjaFJlc3BvbmRlciIsImVsZW1lbnQiLCJpc0hvc3RFbGVtZW50IiwiQm9vbGVhbiIsInByb3BzIiwib25TdGFydFNob3VsZFNldFJlc3BvbmRlciIsImlzSG9zdFRleHRJbnB1dCIsImV2ZW50c0FmZmVjdGVkQnlQb2ludGVyRXZlbnRzUHJvcCIsIlNldCIsInRleHRJbnB1dEV2ZW50c0lnbm9yaW5nRWRpdGFibGVQcm9wIiwiaXNFdmVudEVuYWJsZWQiLCJldmVudE5hbWUiLCJuZWFyZXN0VG91Y2hSZXNwb25kZXIiLCJpc0VkaXRhYmxlVGV4dElucHV0IiwiaGFzIiwiaXNQb2ludGVyRXZlbnRFbmFibGVkIiwidG91Y2hTdGFydCIsInRvdWNoTW92ZSIsIm9uTW92ZVNob3VsZFNldFJlc3BvbmRlciIsInVuZGVmaW5lZCIsImZpbmRFdmVudEhhbmRsZXIiLCJ0b3VjaFJlc3BvbmRlciIsImhhbmRsZXIiLCJnZXRFdmVudEhhbmRsZXIiLCJsb29zZSIsInBhcmVudCIsImZpcmVFdmVudCIsIl9sZW4iLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJkYXRhIiwiQXJyYXkiLCJfa2V5IiwiaXNFbGVtZW50TW91bnRlZCIsInNldE5hdGl2ZVN0YXRlSWZOZWVkZWQiLCJyZXR1cm5WYWx1ZSIsImFwcGx5IiwicHJlc3MiLCJfbGVuMiIsIl9rZXkyIiwiY29uY2F0IiwiY2hhbmdlVGV4dCIsIl9sZW4zIiwiX2tleTMiLCJzY3JvbGwiLCJfbGVuNCIsIl9rZXk0IiwiX2RlZmF1bHQiLCJleHBvcnRzIiwic2Nyb2xsRXZlbnROYW1lcyIsInZhbHVlIiwibmF0aXZlU3RhdGUiLCJ2YWx1ZUZvckVsZW1lbnQiLCJzZXQiLCJpc0hvc3RTY3JvbGxWaWV3IiwiY29udGVudE9mZnNldCIsInRyeUdldENvbnRlbnRPZmZzZXQiLCJjb250ZW50T2Zmc2V0Rm9yRWxlbWVudCIsImV2ZW50IiwiX2V2ZW50JG5hdGl2ZUV2ZW50IiwibmF0aXZlRXZlbnQiLCJ4IiwieSIsIk51bWJlciIsImlzRmluaXRlIiwiX3VudXNlZCJdLCJzb3VyY2VzIjpbIi4uL3NyYy9maXJlLWV2ZW50LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHtcbiAgUHJlc3NhYmxlUHJvcHMsXG4gIFNjcm9sbFZpZXdQcm9wcyxcbiAgVGV4dElucHV0UHJvcHMsXG4gIFRleHRQcm9wcyxcbiAgVmlld1Byb3BzLFxufSBmcm9tICdyZWFjdC1uYXRpdmUnO1xuaW1wb3J0IHR5cGUgeyBSZWFjdFRlc3RJbnN0YW5jZSB9IGZyb20gJ3JlYWN0LXRlc3QtcmVuZGVyZXInO1xuXG5pbXBvcnQgYWN0IGZyb20gJy4vYWN0JztcbmltcG9ydCB7IGdldEV2ZW50SGFuZGxlciB9IGZyb20gJy4vZXZlbnQtaGFuZGxlcic7XG5pbXBvcnQgeyBpc0VsZW1lbnRNb3VudGVkLCBpc0hvc3RFbGVtZW50IH0gZnJvbSAnLi9oZWxwZXJzL2NvbXBvbmVudC10cmVlJztcbmltcG9ydCB7IGlzSG9zdFNjcm9sbFZpZXcsIGlzSG9zdFRleHRJbnB1dCB9IGZyb20gJy4vaGVscGVycy9ob3N0LWNvbXBvbmVudC1uYW1lcyc7XG5pbXBvcnQgeyBpc1BvaW50ZXJFdmVudEVuYWJsZWQgfSBmcm9tICcuL2hlbHBlcnMvcG9pbnRlci1ldmVudHMnO1xuaW1wb3J0IHsgaXNFZGl0YWJsZVRleHRJbnB1dCB9IGZyb20gJy4vaGVscGVycy90ZXh0LWlucHV0JztcbmltcG9ydCB7IG5hdGl2ZVN0YXRlIH0gZnJvbSAnLi9uYXRpdmUtc3RhdGUnO1xuaW1wb3J0IHR5cGUgeyBQb2ludCwgU3RyaW5nV2l0aEF1dG9jb21wbGV0ZSB9IGZyb20gJy4vdHlwZXMnO1xuXG50eXBlIEV2ZW50SGFuZGxlciA9ICguLi5hcmdzOiB1bmtub3duW10pID0+IHVua25vd247XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1RvdWNoUmVzcG9uZGVyKGVsZW1lbnQ6IFJlYWN0VGVzdEluc3RhbmNlKSB7XG4gIGlmICghaXNIb3N0RWxlbWVudChlbGVtZW50KSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIHJldHVybiBCb29sZWFuKGVsZW1lbnQucHJvcHMub25TdGFydFNob3VsZFNldFJlc3BvbmRlcikgfHwgaXNIb3N0VGV4dElucHV0KGVsZW1lbnQpO1xufVxuXG4vKipcbiAqIExpc3Qgb2YgZXZlbnRzIGFmZmVjdGVkIGJ5IGBwb2ludGVyRXZlbnRzYCBwcm9wLlxuICpcbiAqIE5vdGU6IGBmaXJlRXZlbnRgIGlzIGFjY2VwdGluZyBib3RoIGBwcmVzc2AgYW5kIGBvblByZXNzYCBmb3IgZXZlbnQgbmFtZXMsXG4gKiBzbyB3ZSBuZWVkIGNvdmVyIGJvdGggZm9ybXMuXG4gKi9cbmNvbnN0IGV2ZW50c0FmZmVjdGVkQnlQb2ludGVyRXZlbnRzUHJvcCA9IG5ldyBTZXQoWydwcmVzcycsICdvblByZXNzJ10pO1xuXG4vKipcbiAqIExpc3Qgb2YgYFRleHRJbnB1dGAgZXZlbnRzIG5vdCBhZmZlY3RlZCBieSBgZWRpdGFibGVgIHByb3AuXG4gKlxuICogTm90ZTogYGZpcmVFdmVudGAgaXMgYWNjZXB0aW5nIGJvdGggYHByZXNzYCBhbmQgYG9uUHJlc3NgIGZvciBldmVudCBuYW1lcyxcbiAqIHNvIHdlIG5lZWQgY292ZXIgYm90aCBmb3Jtcy5cbiAqL1xuY29uc3QgdGV4dElucHV0RXZlbnRzSWdub3JpbmdFZGl0YWJsZVByb3AgPSBuZXcgU2V0KFtcbiAgJ2NvbnRlbnRTaXplQ2hhbmdlJyxcbiAgJ29uQ29udGVudFNpemVDaGFuZ2UnLFxuICAnbGF5b3V0JyxcbiAgJ29uTGF5b3V0JyxcbiAgJ3Njcm9sbCcsXG4gICdvblNjcm9sbCcsXG5dKTtcblxuZXhwb3J0IGZ1bmN0aW9uIGlzRXZlbnRFbmFibGVkKFxuICBlbGVtZW50OiBSZWFjdFRlc3RJbnN0YW5jZSxcbiAgZXZlbnROYW1lOiBzdHJpbmcsXG4gIG5lYXJlc3RUb3VjaFJlc3BvbmRlcj86IFJlYWN0VGVzdEluc3RhbmNlLFxuKSB7XG4gIGlmIChuZWFyZXN0VG91Y2hSZXNwb25kZXIgIT0gbnVsbCAmJiBpc0hvc3RUZXh0SW5wdXQobmVhcmVzdFRvdWNoUmVzcG9uZGVyKSkge1xuICAgIHJldHVybiAoXG4gICAgICBpc0VkaXRhYmxlVGV4dElucHV0KG5lYXJlc3RUb3VjaFJlc3BvbmRlcikgfHxcbiAgICAgIHRleHRJbnB1dEV2ZW50c0lnbm9yaW5nRWRpdGFibGVQcm9wLmhhcyhldmVudE5hbWUpXG4gICAgKTtcbiAgfVxuXG4gIGlmIChldmVudHNBZmZlY3RlZEJ5UG9pbnRlckV2ZW50c1Byb3AuaGFzKGV2ZW50TmFtZSkgJiYgIWlzUG9pbnRlckV2ZW50RW5hYmxlZChlbGVtZW50KSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGNvbnN0IHRvdWNoU3RhcnQgPSBuZWFyZXN0VG91Y2hSZXNwb25kZXI/LnByb3BzLm9uU3RhcnRTaG91bGRTZXRSZXNwb25kZXI/LigpO1xuICBjb25zdCB0b3VjaE1vdmUgPSBuZWFyZXN0VG91Y2hSZXNwb25kZXI/LnByb3BzLm9uTW92ZVNob3VsZFNldFJlc3BvbmRlcj8uKCk7XG4gIGlmICh0b3VjaFN0YXJ0IHx8IHRvdWNoTW92ZSkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgcmV0dXJuIHRvdWNoU3RhcnQgPT09IHVuZGVmaW5lZCAmJiB0b3VjaE1vdmUgPT09IHVuZGVmaW5lZDtcbn1cblxuZnVuY3Rpb24gZmluZEV2ZW50SGFuZGxlcihcbiAgZWxlbWVudDogUmVhY3RUZXN0SW5zdGFuY2UsXG4gIGV2ZW50TmFtZTogc3RyaW5nLFxuICBuZWFyZXN0VG91Y2hSZXNwb25kZXI/OiBSZWFjdFRlc3RJbnN0YW5jZSxcbik6IEV2ZW50SGFuZGxlciB8IG51bGwge1xuICBjb25zdCB0b3VjaFJlc3BvbmRlciA9IGlzVG91Y2hSZXNwb25kZXIoZWxlbWVudCkgPyBlbGVtZW50IDogbmVhcmVzdFRvdWNoUmVzcG9uZGVyO1xuXG4gIGNvbnN0IGhhbmRsZXIgPSBnZXRFdmVudEhhbmRsZXIoZWxlbWVudCwgZXZlbnROYW1lLCB7IGxvb3NlOiB0cnVlIH0pO1xuICBpZiAoaGFuZGxlciAmJiBpc0V2ZW50RW5hYmxlZChlbGVtZW50LCBldmVudE5hbWUsIHRvdWNoUmVzcG9uZGVyKSkgcmV0dXJuIGhhbmRsZXI7XG5cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9wcmVmZXItb3B0aW9uYWwtY2hhaW5cbiAgaWYgKGVsZW1lbnQucGFyZW50ID09PSBudWxsIHx8IGVsZW1lbnQucGFyZW50LnBhcmVudCA9PT0gbnVsbCkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgcmV0dXJuIGZpbmRFdmVudEhhbmRsZXIoZWxlbWVudC5wYXJlbnQsIGV2ZW50TmFtZSwgdG91Y2hSZXNwb25kZXIpO1xufVxuXG4vLyBTdHJpbmcgdW5pb24gdHlwZSBvZiBrZXlzIG9mIFQgdGhhdCBzdGFydCB3aXRoIG9uLCBzdHJpcHBlZCBvZiAnb24nXG50eXBlIEV2ZW50TmFtZUV4dHJhY3RvcjxUPiA9IGtleW9mIHtcbiAgW0sgaW4ga2V5b2YgVCBhcyBLIGV4dGVuZHMgYG9uJHtpbmZlciBSZXN0fWAgPyBVbmNhcGl0YWxpemU8UmVzdD4gOiBuZXZlcl06IFRbS107XG59O1xuXG50eXBlIEV2ZW50TmFtZSA9IFN0cmluZ1dpdGhBdXRvY29tcGxldGU8XG4gIHwgRXZlbnROYW1lRXh0cmFjdG9yPFZpZXdQcm9wcz5cbiAgfCBFdmVudE5hbWVFeHRyYWN0b3I8VGV4dFByb3BzPlxuICB8IEV2ZW50TmFtZUV4dHJhY3RvcjxUZXh0SW5wdXRQcm9wcz5cbiAgfCBFdmVudE5hbWVFeHRyYWN0b3I8UHJlc3NhYmxlUHJvcHM+XG4gIHwgRXZlbnROYW1lRXh0cmFjdG9yPFNjcm9sbFZpZXdQcm9wcz5cbj47XG5cbmZ1bmN0aW9uIGZpcmVFdmVudChlbGVtZW50OiBSZWFjdFRlc3RJbnN0YW5jZSwgZXZlbnROYW1lOiBFdmVudE5hbWUsIC4uLmRhdGE6IHVua25vd25bXSkge1xuICBpZiAoIWlzRWxlbWVudE1vdW50ZWQoZWxlbWVudCkpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBzZXROYXRpdmVTdGF0ZUlmTmVlZGVkKGVsZW1lbnQsIGV2ZW50TmFtZSwgZGF0YVswXSk7XG5cbiAgY29uc3QgaGFuZGxlciA9IGZpbmRFdmVudEhhbmRsZXIoZWxlbWVudCwgZXZlbnROYW1lKTtcbiAgaWYgKCFoYW5kbGVyKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgbGV0IHJldHVyblZhbHVlO1xuICB2b2lkIGFjdCgoKSA9PiB7XG4gICAgcmV0dXJuVmFsdWUgPSBoYW5kbGVyKC4uLmRhdGEpO1xuICB9KTtcblxuICByZXR1cm4gcmV0dXJuVmFsdWU7XG59XG5cbmZpcmVFdmVudC5wcmVzcyA9IChlbGVtZW50OiBSZWFjdFRlc3RJbnN0YW5jZSwgLi4uZGF0YTogdW5rbm93bltdKSA9PlxuICBmaXJlRXZlbnQoZWxlbWVudCwgJ3ByZXNzJywgLi4uZGF0YSk7XG5cbmZpcmVFdmVudC5jaGFuZ2VUZXh0ID0gKGVsZW1lbnQ6IFJlYWN0VGVzdEluc3RhbmNlLCAuLi5kYXRhOiB1bmtub3duW10pID0+XG4gIGZpcmVFdmVudChlbGVtZW50LCAnY2hhbmdlVGV4dCcsIC4uLmRhdGEpO1xuXG5maXJlRXZlbnQuc2Nyb2xsID0gKGVsZW1lbnQ6IFJlYWN0VGVzdEluc3RhbmNlLCAuLi5kYXRhOiB1bmtub3duW10pID0+XG4gIGZpcmVFdmVudChlbGVtZW50LCAnc2Nyb2xsJywgLi4uZGF0YSk7XG5cbmV4cG9ydCBkZWZhdWx0IGZpcmVFdmVudDtcblxuY29uc3Qgc2Nyb2xsRXZlbnROYW1lcyA9IG5ldyBTZXQoW1xuICAnc2Nyb2xsJyxcbiAgJ3Njcm9sbEJlZ2luRHJhZycsXG4gICdzY3JvbGxFbmREcmFnJyxcbiAgJ21vbWVudHVtU2Nyb2xsQmVnaW4nLFxuICAnbW9tZW50dW1TY3JvbGxFbmQnLFxuXSk7XG5cbmZ1bmN0aW9uIHNldE5hdGl2ZVN0YXRlSWZOZWVkZWQoZWxlbWVudDogUmVhY3RUZXN0SW5zdGFuY2UsIGV2ZW50TmFtZTogc3RyaW5nLCB2YWx1ZTogdW5rbm93bikge1xuICBpZiAoZXZlbnROYW1lID09PSAnY2hhbmdlVGV4dCcgJiYgdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyAmJiBpc0VkaXRhYmxlVGV4dElucHV0KGVsZW1lbnQpKSB7XG4gICAgbmF0aXZlU3RhdGUudmFsdWVGb3JFbGVtZW50LnNldChlbGVtZW50LCB2YWx1ZSk7XG4gIH1cblxuICBpZiAoc2Nyb2xsRXZlbnROYW1lcy5oYXMoZXZlbnROYW1lKSAmJiBpc0hvc3RTY3JvbGxWaWV3KGVsZW1lbnQpKSB7XG4gICAgY29uc3QgY29udGVudE9mZnNldCA9IHRyeUdldENvbnRlbnRPZmZzZXQodmFsdWUpO1xuICAgIGlmIChjb250ZW50T2Zmc2V0KSB7XG4gICAgICBuYXRpdmVTdGF0ZS5jb250ZW50T2Zmc2V0Rm9yRWxlbWVudC5zZXQoZWxlbWVudCwgY29udGVudE9mZnNldCk7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIHRyeUdldENvbnRlbnRPZmZzZXQoZXZlbnQ6IHVua25vd24pOiBQb2ludCB8IG51bGwge1xuICB0cnkge1xuICAgIC8vIEB0cy1leHBlY3QtZXJyb3I6IHRyeSB0byBleHRyYWN0IGNvbnRlbnRPZmZzZXQgZnJvbSB0aGUgZXZlbnQgdmFsdWVcbiAgICBjb25zdCBjb250ZW50T2Zmc2V0ID0gZXZlbnQ/Lm5hdGl2ZUV2ZW50Py5jb250ZW50T2Zmc2V0O1xuICAgIGNvbnN0IHggPSBjb250ZW50T2Zmc2V0Py54O1xuICAgIGNvbnN0IHkgPSBjb250ZW50T2Zmc2V0Py55O1xuICAgIGlmICh0eXBlb2YgeCA9PT0gJ251bWJlcicgfHwgdHlwZW9mIHkgPT09ICdudW1iZXInKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB4OiBOdW1iZXIuaXNGaW5pdGUoeCkgPyB4IDogMCxcbiAgICAgICAgeTogTnVtYmVyLmlzRmluaXRlKHkpID8geSA6IDAsXG4gICAgICB9O1xuICAgIH1cbiAgfSBjYXRjaCB7XG4gICAgLy8gRG8gbm90aGluZ1xuICB9XG5cbiAgcmV0dXJuIG51bGw7XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBU0EsSUFBQUEsSUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsYUFBQSxHQUFBRCxPQUFBO0FBQ0EsSUFBQUUsY0FBQSxHQUFBRixPQUFBO0FBQ0EsSUFBQUcsbUJBQUEsR0FBQUgsT0FBQTtBQUNBLElBQUFJLGNBQUEsR0FBQUosT0FBQTtBQUNBLElBQUFLLFVBQUEsR0FBQUwsT0FBQTtBQUNBLElBQUFNLFlBQUEsR0FBQU4sT0FBQTtBQUE2QyxTQUFBRCx1QkFBQVEsQ0FBQTtFQUFBLE9BQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUE7SUFBQUUsT0FBQSxFQUFBRjtFQUFBO0FBQUE7QUFLdEMsU0FBU0csZ0JBQWdCQSxDQUFDQyxPQUEwQixFQUFFO0VBQzNELElBQUksQ0FBQyxJQUFBVCxjQUFBLENBQUFVLGFBQWEsRUFBQ0QsT0FBTyxDQUFDLEVBQUU7SUFDM0IsT0FBTyxLQUFLO0VBQ2Q7RUFFQSxPQUFPRSxPQUFPLENBQUNGLE9BQU8sQ0FBQ0csS0FBSyxDQUFDQyx5QkFBeUIsQ0FBQyxJQUFJLElBQUFaLG1CQUFBLENBQUFhLGVBQWUsRUFBQ0wsT0FBTyxDQUFDO0FBQ3JGO0FBUUEsSUFBTU0saUNBQWlDLEdBQUcsSUFBSUMsR0FBRyxDQUFDLENBQUMsT0FBTyxFQUFFLFNBQVMsQ0FBQyxDQUFDO0FBUXZFLElBQU1DLG1DQUFtQyxHQUFHLElBQUlELEdBQUcsQ0FBQyxDQUNsRCxtQkFBbUIsRUFDbkIscUJBQXFCLEVBQ3JCLFFB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