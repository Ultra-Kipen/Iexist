583d807183ae1dfb7cd8db9e93b6ac53
_getJestObj().mock("../../src/services/api/notificationService", function () {
  return {
    getNotifications: jest.fn(),
    markAsRead: jest.fn(),
    markAllAsRead: jest.fn(),
    deleteNotification: jest.fn()
  };
});
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _react = _interopRequireDefault(require("react"));
var _react2 = require("@testing-library/react");
var _NotificationContext = require("../../src/contexts/NotificationContext");
var _notificationService = _interopRequireDefault(require("../../src/services/api/notificationService"));
var _jsxRuntime = require("react/jsx-runtime");
function _getJestObj() {
  var _require = require("@jest/globals"),
    jest = _require.jest;
  _getJestObj = function _getJestObj() {
    return jest;
  };
  return jest;
}
var TestComponent = function TestComponent() {
  var _useNotification = (0, _NotificationContext.useNotification)(),
    notifications = _useNotification.notifications,
    unreadCount = _useNotification.unreadCount,
    isLoading = _useNotification.isLoading,
    error = _useNotification.error,
    markAsRead = _useNotification.markAsRead,
    markAllAsRead = _useNotification.markAllAsRead,
    deleteNotification = _useNotification.deleteNotification;
  return (0, _jsxRuntime.jsxs)("div", {
    children: [(0, _jsxRuntime.jsx)("div", {
      "data-testid": "loading",
      children: isLoading ? 'loading' : 'not-loading'
    }), (0, _jsxRuntime.jsx)("div", {
      "data-testid": "error",
      children: error || 'no-error'
    }), (0, _jsxRuntime.jsx)("div", {
      "data-testid": "unread-count",
      children: unreadCount.toString()
    }), (0, _jsxRuntime.jsx)("div", {
      "data-testid": "notifications-count",
      children: notifications.length.toString()
    }), (0, _jsxRuntime.jsx)("button", {
      "data-testid": "mark-read",
      onClick: function onClick() {
        return markAsRead(1);
      },
      children: "Mark Read"
    }), (0, _jsxRuntime.jsx)("button", {
      "data-testid": "mark-all-read",
      onClick: function onClick() {
        return markAllAsRead();
      },
      children: "Mark All Read"
    }), (0, _jsxRuntime.jsx)("button", {
      "data-testid": "delete-notification",
      onClick: function onClick() {
        return deleteNotification(1);
      },
      children: "Delete"
    })]
  });
};
describe('NotificationContext', function () {
  var mockNotifications = [{
    id: 1,
    user_id: 1,
    content: 'Test notification 1',
    notification_type: 'like',
    is_read: false,
    created_at: '2024-01-01T00:00:00Z'
  }, {
    id: 2,
    user_id: 1,
    content: 'Test notification 2',
    notification_type: 'comment',
    is_read: true,
    created_at: '2024-01-02T00:00:00Z'
  }];
  beforeEach(function () {
    jest.useFakeTimers();
    jest.clearAllMocks();
    _notificationService.default.getNotifications.mockResolvedValue({
      data: mockNotifications
    });
    _notificationService.default.markAsRead.mockResolvedValue({
      success: true
    });
    _notificationService.default.markAllAsRead.mockResolvedValue({
      success: true
    });
    _notificationService.default.deleteNotification.mockResolvedValue({
      success: true
    });
  });
  afterEach(function () {
    jest.runAllTimers();
    jest.useRealTimers();
  });
  var checkLoadingAndGetTexts = function () {
    var _ref = (0, _asyncToGenerator2.default)(function* (renderResult) {
      yield (0, _react2.waitFor)(function () {
        var loadingElement = renderResult.getByTestId('loading');
        expect(loadingElement.textContent).toBe('not-loading');
      }, {
        timeout: 10000
      });
      var loadingElement = renderResult.getByTestId('loading');
      var notificationsCountElement = renderResult.getByTestId('notifications-count');
      var unreadCountElement = renderResult.getByTestId('unread-count');
      var errorElement = renderResult.getByTestId('error');
      return {
        loadingText: loadingElement.textContent || '',
        notificationsCountText: notificationsCountElement.textContent || '',
        unreadCountText: unreadCountElement.textContent || '',
        errorText: errorElement.textContent || ''
      };
    });
    return function checkLoadingAndGetTexts(_x) {
      return _ref.apply(this, arguments);
    };
  }();
  it('초기 상태가 올바르게 설정된다', (0, _asyncToGenerator2.default)(function* () {
    jest.setTimeout(30000);
    var renderResult = (0, _react2.render)((0, _jsxRuntime.jsx)(_NotificationContext.NotificationProvider, {
      children: (0, _jsxRuntime.jsx)(TestComponent, {})
    }));
    var _yield$checkLoadingAn = yield checkLoadingAndGetTexts(renderResult),
      loadingText = _yield$checkLoadingAn.loadingText,
      notificationsCountText = _yield$checkLoadingAn.notificationsCountText,
      unreadCountText = _yield$checkLoadingAn.unreadCountText,
      errorText = _yield$checkLoadingAn.errorText;
    expect(notificationsCountText).toBe('2');
    expect(unreadCountText).toBe('1');
    expect(errorText).toBe('no-error');
  }));
  it('알림을 읽음 처리할 수 있다', (0, _asyncToGenerator2.default)(function* () {
    jest.setTimeout(30000);
    var renderResult = (0, _react2.render)((0, _jsxRuntime.jsx)(_NotificationContext.NotificationProvider, {
      children: (0, _jsxRuntime.jsx)(TestComponent, {})
    }));
    yield checkLoadingAndGetTexts(renderResult);
    var markReadButton = renderResult.getByTestId('mark-read');
    yield (0, _react2.act)((0, _asyncToGenerator2.default)(function* () {
      _react2.fireEvent.click(markReadButton);
    }));
    expect(_notificationService.default.markAsRead).toHaveBeenCalledWith(1);
    expect(_notificationService.default.getNotifications).toHaveBeenCalledTimes(2);
  }));
  it('모든 알림을 읽음 처리할 수 있다', (0, _asyncToGenerator2.default)(function* () {
    jest.setTimeout(30000);
    var renderResult = (0, _react2.render)((0, _jsxRuntime.jsx)(_NotificationContext.NotificationProvider, {
      children: (0, _jsxRuntime.jsx)(TestComponent, {})
    }));
    yield checkLoadingAndGetTexts(renderResult);
    var markAllReadButton = renderResult.getByTestId('mark-all-read');
    yield (0, _react2.act)((0, _asyncToGenerator2.default)(function* () {
      _react2.fireEvent.press(markAllReadButton);
    }));
    expect(_notificationService.default.markAllAsRead).toHaveBeenCalled();
    expect(_notificationService.default.getNotifications).toHaveBeenCalledTimes(2);
  }));
  it('알림을 삭제할 수 있다', (0, _asyncToGenerator2.default)(function* () {
    jest.setTimeout(30000);
    var renderResult = (0, _react2.render)((0, _jsxRuntime.jsx)(_NotificationContext.NotificationProvider, {
      children: (0, _jsxRuntime.jsx)(TestComponent, {})
    }));
    yield checkLoadingAndGetTexts(renderResult);
    var deleteButton = renderResult.getByTestId('delete-notification');
    yield (0, _react2.act)((0, _asyncToGenerator2.default)(function* () {
      _react2.fireEvent.press(deleteButton);
    }));
    expect(_notificationService.default.deleteNotification).toHaveBeenCalledWith(1);
    expect(_notificationService.default.getNotifications).toHaveBeenCalledTimes(2);
  }));
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZ2V0SmVzdE9iaiIsIm1vY2siLCJnZXROb3RpZmljYXRpb25zIiwiamVzdCIsImZuIiwibWFya0FzUmVhZCIsIm1hcmtBbGxBc1JlYWQiLCJkZWxldGVOb3RpZmljYXRpb24iLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9hc3luY1RvR2VuZXJhdG9yMiIsIl9yZWFjdCIsIl9yZWFjdDIiLCJfTm90aWZpY2F0aW9uQ29udGV4dCIsIl9ub3RpZmljYXRpb25TZXJ2aWNlIiwiX2pzeFJ1bnRpbWUiLCJfcmVxdWlyZSIsIlRlc3RDb21wb25lbnQiLCJfdXNlTm90aWZpY2F0aW9uIiwidXNlTm90aWZpY2F0aW9uIiwibm90aWZpY2F0aW9ucyIsInVucmVhZENvdW50IiwiaXNMb2FkaW5nIiwiZXJyb3IiLCJqc3hzIiwiY2hpbGRyZW4iLCJqc3giLCJ0b1N0cmluZyIsImxlbmd0aCIsIm9uQ2xpY2siLCJkZXNjcmliZSIsIm1vY2tOb3RpZmljYXRpb25zIiwiaWQiLCJ1c2VyX2lkIiwiY29udGVudCIsIm5vdGlmaWNhdGlvbl90eXBlIiwiaXNfcmVhZCIsImNyZWF0ZWRfYXQiLCJiZWZvcmVFYWNoIiwidXNlRmFrZVRpbWVycyIsImNsZWFyQWxsTW9ja3MiLCJub3RpZmljYXRpb25TZXJ2aWNlIiwibW9ja1Jlc29sdmVkVmFsdWUiLCJkYXRhIiwic3VjY2VzcyIsImFmdGVyRWFjaCIsInJ1bkFsbFRpbWVycyIsInVzZVJlYWxUaW1lcnMiLCJjaGVja0xvYWRpbmdBbmRHZXRUZXh0cyIsIl9yZWYiLCJkZWZhdWx0IiwicmVuZGVyUmVzdWx0Iiwid2FpdEZvciIsImxvYWRpbmdFbGVtZW50IiwiZ2V0QnlUZXN0SWQiLCJleHBlY3QiLCJ0ZXh0Q29udGVudCIsInRvQmUiLCJ0aW1lb3V0Iiwibm90aWZpY2F0aW9uc0NvdW50RWxlbWVudCIsInVucmVhZENvdW50RWxlbWVudCIsImVycm9yRWxlbWVudCIsImxvYWRpbmdUZXh0Iiwibm90aWZpY2F0aW9uc0NvdW50VGV4dCIsInVucmVhZENvdW50VGV4dCIsImVycm9yVGV4dCIsIl94IiwiYXBwbHkiLCJhcmd1bWVudHMiLCJpdCIsInNldFRpbWVvdXQiLCJyZW5kZXIiLCJOb3RpZmljYXRpb25Qcm92aWRlciIsIl95aWVsZCRjaGVja0xvYWRpbmdBbiIsIm1hcmtSZWFkQnV0dG9uIiwiYWN0IiwiZmlyZUV2ZW50IiwiY2xpY2siLCJ0b0hhdmVCZWVuQ2FsbGVkV2l0aCIsInRvSGF2ZUJlZW5DYWxsZWRUaW1lcyIsIm1hcmtBbGxSZWFkQnV0dG9uIiwicHJlc3MiLCJ0b0hhdmVCZWVuQ2FsbGVkIiwiZGVsZXRlQnV0dG9uIl0sInNvdXJjZXMiOlsiTm90aWZpY2F0aW9uQ29udGV4dC50ZXN0LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBfX3Rlc3RzX18vY29udGV4dHMvTm90aWZpY2F0aW9uQ29udGV4dC50ZXN0LnRzeFxyXG5pbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyByZW5kZXIsIGZpcmVFdmVudCwgYWN0LCB3YWl0Rm9yIH0gZnJvbSAnQHRlc3RpbmctbGlicmFyeS9yZWFjdCc7XHJcbmltcG9ydCB7IE5vdGlmaWNhdGlvblByb3ZpZGVyLCB1c2VOb3RpZmljYXRpb24gfSBmcm9tICcuLi8uLi9zcmMvY29udGV4dHMvTm90aWZpY2F0aW9uQ29udGV4dCc7XHJcbmltcG9ydCBub3RpZmljYXRpb25TZXJ2aWNlIGZyb20gJy4uLy4uL3NyYy9zZXJ2aWNlcy9hcGkvbm90aWZpY2F0aW9uU2VydmljZSc7XHJcblxyXG4vLyDrqqjsnZgg7JWM66a8IOyEnOu5hOyKpFxyXG5qZXN0Lm1vY2soJy4uLy4uL3NyYy9zZXJ2aWNlcy9hcGkvbm90aWZpY2F0aW9uU2VydmljZScsICgpID0+ICh7XHJcbiAgZ2V0Tm90aWZpY2F0aW9uczogamVzdC5mbigpLFxyXG4gIG1hcmtBc1JlYWQ6IGplc3QuZm4oKSxcclxuICBtYXJrQWxsQXNSZWFkOiBqZXN0LmZuKCksXHJcbiAgZGVsZXRlTm90aWZpY2F0aW9uOiBqZXN0LmZuKCksXHJcbn0pKTtcclxuXHJcbmNvbnN0IFRlc3RDb21wb25lbnQgPSAoKSA9PiB7XHJcbiAgY29uc3QgeyBcclxuICAgIG5vdGlmaWNhdGlvbnMsIFxyXG4gICAgdW5yZWFkQ291bnQsIFxyXG4gICAgaXNMb2FkaW5nLCBcclxuICAgIGVycm9yLFxyXG4gICAgbWFya0FzUmVhZCxcclxuICAgIG1hcmtBbGxBc1JlYWQsXHJcbiAgICBkZWxldGVOb3RpZmljYXRpb25cclxuICB9ID0gdXNlTm90aWZpY2F0aW9uKCk7XHJcblxyXG4gIHJldHVybiAoXHJcbiAgICA8ZGl2PlxyXG4gICAgICA8ZGl2IGRhdGEtdGVzdGlkPVwibG9hZGluZ1wiPlxyXG4gICAgICAgIHtpc0xvYWRpbmcgPyAnbG9hZGluZycgOiAnbm90LWxvYWRpbmcnfVxyXG4gICAgICA8L2Rpdj5cclxuICAgICAgPGRpdiBkYXRhLXRlc3RpZD1cImVycm9yXCI+XHJcbiAgICAgICAge2Vycm9yIHx8ICduby1lcnJvcid9XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgICA8ZGl2IGRhdGEtdGVzdGlkPVwidW5yZWFkLWNvdW50XCI+XHJcbiAgICAgICAge3VucmVhZENvdW50LnRvU3RyaW5nKCl9XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgICA8ZGl2IGRhdGEtdGVzdGlkPVwibm90aWZpY2F0aW9ucy1jb3VudFwiPlxyXG4gICAgICAgIHtub3RpZmljYXRpb25zLmxlbmd0aC50b1N0cmluZygpfVxyXG4gICAgICA8L2Rpdj5cclxuICAgICAgPGJ1dHRvbiBkYXRhLXRlc3RpZD1cIm1hcmstcmVhZFwiIG9uQ2xpY2s9eygpID0+IG1hcmtBc1JlYWQoMSl9Pk1hcmsgUmVhZDwvYnV0dG9uPlxyXG4gICAgICA8YnV0dG9uIGRhdGEtdGVzdGlkPVwibWFyay1hbGwtcmVhZFwiIG9uQ2xpY2s9eygpID0+IG1hcmtBbGxBc1JlYWQoKX0+TWFyayBBbGwgUmVhZDwvYnV0dG9uPlxyXG4gICAgICA8YnV0dG9uIGRhdGEtdGVzdGlkPVwiZGVsZXRlLW5vdGlmaWNhdGlvblwiIG9uQ2xpY2s9eygpID0+IGRlbGV0ZU5vdGlmaWNhdGlvbigxKX0+RGVsZXRlPC9idXR0b24+XHJcbiAgICA8L2Rpdj5cclxuICApO1xyXG59O1xyXG5kZXNjcmliZSgnTm90aWZpY2F0aW9uQ29udGV4dCcsICgpID0+IHtcclxuICBjb25zdCBtb2NrTm90aWZpY2F0aW9ucyA9IFtcclxuICAgIHtcclxuICAgICAgaWQ6IDEsXHJcbiAgICAgIHVzZXJfaWQ6IDEsXHJcbiAgICAgIGNvbnRlbnQ6ICdUZXN0IG5vdGlmaWNhdGlvbiAxJyxcclxuICAgICAgbm90aWZpY2F0aW9uX3R5cGU6ICdsaWtlJyxcclxuICAgICAgaXNfcmVhZDogZmFsc2UsXHJcbiAgICAgIGNyZWF0ZWRfYXQ6ICcyMDI0LTAxLTAxVDAwOjAwOjAwWidcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgIGlkOiAyLFxyXG4gICAgICB1c2VyX2lkOiAxLFxyXG4gICAgICBjb250ZW50OiAnVGVzdCBub3RpZmljYXRpb24gMicsXHJcbiAgICAgIG5vdGlmaWNhdGlvbl90eXBlOiAnY29tbWVudCcsXHJcbiAgICAgIGlzX3JlYWQ6IHRydWUsXHJcbiAgICAgIGNyZWF0ZWRfYXQ6ICcyMDI0LTAxLTAyVDAwOjAwOjAwWidcclxuICAgIH1cclxuICBdO1xyXG5cclxuICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgIGplc3QudXNlRmFrZVRpbWVycygpO1xyXG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XHJcbiAgICBcclxuICAgIC8vIGdldE5vdGlmaWNhdGlvbnMg66qo7YK5XHJcbiAgICAobm90aWZpY2F0aW9uU2VydmljZS5nZXROb3RpZmljYXRpb25zIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoe1xyXG4gICAgICBkYXRhOiBtb2NrTm90aWZpY2F0aW9uc1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8vIG1hcmtBc1JlYWQg66qo7YK5XHJcbiAgICAobm90aWZpY2F0aW9uU2VydmljZS5tYXJrQXNSZWFkIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoe1xyXG4gICAgICBzdWNjZXNzOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLy8gbWFya0FsbEFzUmVhZCDrqqjtgrlcclxuICAgIChub3RpZmljYXRpb25TZXJ2aWNlLm1hcmtBbGxBc1JlYWQgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWVcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvLyBkZWxldGVOb3RpZmljYXRpb24g66qo7YK5XHJcbiAgICAobm90aWZpY2F0aW9uU2VydmljZS5kZWxldGVOb3RpZmljYXRpb24gYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWVcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBhZnRlckVhY2goKCkgPT4ge1xyXG4gICAgamVzdC5ydW5BbGxUaW1lcnMoKTtcclxuICAgIGplc3QudXNlUmVhbFRpbWVycygpO1xyXG4gIH0pO1xyXG5cclxuICBjb25zdCBjaGVja0xvYWRpbmdBbmRHZXRUZXh0cyA9IGFzeW5jIChyZW5kZXJSZXN1bHQ6IFJldHVyblR5cGU8dHlwZW9mIHJlbmRlcj4pID0+IHtcclxuICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xyXG4gICAgICBjb25zdCBsb2FkaW5nRWxlbWVudCA9IHJlbmRlclJlc3VsdC5nZXRCeVRlc3RJZCgnbG9hZGluZycpO1xyXG4gICAgICBleHBlY3QobG9hZGluZ0VsZW1lbnQudGV4dENvbnRlbnQpLnRvQmUoJ25vdC1sb2FkaW5nJyk7XHJcbiAgICB9LCB7IHRpbWVvdXQ6IDEwMDAwIH0pO1xyXG4gIFxyXG4gICAgY29uc3QgbG9hZGluZ0VsZW1lbnQgPSByZW5kZXJSZXN1bHQuZ2V0QnlUZXN0SWQoJ2xvYWRpbmcnKTtcclxuICAgIGNvbnN0IG5vdGlmaWNhdGlvbnNDb3VudEVsZW1lbnQgPSByZW5kZXJSZXN1bHQuZ2V0QnlUZXN0SWQoJ25vdGlmaWNhdGlvbnMtY291bnQnKTtcclxuICAgIGNvbnN0IHVucmVhZENvdW50RWxlbWVudCA9IHJlbmRlclJlc3VsdC5nZXRCeVRlc3RJZCgndW5yZWFkLWNvdW50Jyk7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSByZW5kZXJSZXN1bHQuZ2V0QnlUZXN0SWQoJ2Vycm9yJyk7XHJcbiAgXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBsb2FkaW5nVGV4dDogbG9hZGluZ0VsZW1lbnQudGV4dENvbnRlbnQgfHwgJycsXHJcbiAgICAgIG5vdGlmaWNhdGlvbnNDb3VudFRleHQ6IG5vdGlmaWNhdGlvbnNDb3VudEVsZW1lbnQudGV4dENvbnRlbnQgfHwgJycsXHJcbiAgICAgIHVucmVhZENvdW50VGV4dDogdW5yZWFkQ291bnRFbGVtZW50LnRleHRDb250ZW50IHx8ICcnLFxyXG4gICAgICBlcnJvclRleHQ6IGVycm9yRWxlbWVudC50ZXh0Q29udGVudCB8fCAnJ1xyXG4gICAgfTtcclxuICB9O1xyXG4gIGl0KCfstIjquLAg7IOB7YOc6rCAIOyYrOuwlOultOqyjCDshKTsoJXrkJzri6QnLCBhc3luYyAoKSA9PiB7XHJcbiAgICBqZXN0LnNldFRpbWVvdXQoMzAwMDApO1xyXG5cclxuICAgIGNvbnN0IHJlbmRlclJlc3VsdCA9IHJlbmRlcihcclxuICAgICAgPE5vdGlmaWNhdGlvblByb3ZpZGVyPlxyXG4gICAgICAgIDxUZXN0Q29tcG9uZW50IC8+XHJcbiAgICAgIDwvTm90aWZpY2F0aW9uUHJvdmlkZXI+XHJcbiAgICApO1xyXG5cclxuICAgIGNvbnN0IHsgXHJcbiAgICAgIGxvYWRpbmdUZXh0LCBcclxuICAgICAgbm90aWZpY2F0aW9uc0NvdW50VGV4dCwgXHJcbiAgICAgIHVucmVhZENvdW50VGV4dCwgXHJcbiAgICAgIGVycm9yVGV4dCBcclxuICAgIH0gPSBhd2FpdCBjaGVja0xvYWRpbmdBbmRHZXRUZXh0cyhyZW5kZXJSZXN1bHQpO1xyXG5cclxuICAgIGV4cGVjdChub3RpZmljYXRpb25zQ291bnRUZXh0KS50b0JlKCcyJyk7XHJcbiAgICBleHBlY3QodW5yZWFkQ291bnRUZXh0KS50b0JlKCcxJyk7XHJcbiAgICBleHBlY3QoZXJyb3JUZXh0KS50b0JlKCduby1lcnJvcicpO1xyXG4gIH0pO1xyXG5cclxuICBpdCgn7JWM66a87J2EIOydveydjCDsspjrpqztlaAg7IiYIOyeiOuLpCcsIGFzeW5jICgpID0+IHtcclxuICAgIGplc3Quc2V0VGltZW91dCgzMDAwMCk7XHJcblxyXG4gICAgY29uc3QgcmVuZGVyUmVzdWx0ID0gcmVuZGVyKFxyXG4gICAgICA8Tm90aWZpY2F0aW9uUHJvdmlkZXI+XHJcbiAgICAgICAgPFRlc3RDb21wb25lbnQgLz5cclxuICAgICAgPC9Ob3RpZmljYXRpb25Qcm92aWRlcj5cclxuICAgICk7XHJcblxyXG4gICAgYXdhaXQgY2hlY2tMb2FkaW5nQW5kR2V0VGV4dHMocmVuZGVyUmVzdWx0KTtcclxuXHJcbiAgICBjb25zdCBtYXJrUmVhZEJ1dHRvbiA9IHJlbmRlclJlc3VsdC5nZXRCeVRlc3RJZCgnbWFyay1yZWFkJyk7XHJcbiAgICBcclxuICAgIGF3YWl0IGFjdChhc3luYyAoKSA9PiB7XHJcbiAgICAgIGZpcmVFdmVudC5jbGljayhtYXJrUmVhZEJ1dHRvbik7XHJcbiAgICB9KTtcclxuXHJcbiAgICBleHBlY3Qobm90aWZpY2F0aW9uU2VydmljZS5tYXJrQXNSZWFkKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgxKTtcclxuICAgIGV4cGVjdChub3RpZmljYXRpb25TZXJ2aWNlLmdldE5vdGlmaWNhdGlvbnMpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygyKTtcclxuICB9KTtcclxuXHJcbiAgaXQoJ+uqqOuToCDslYzrprzsnYQg7J297J2MIOyymOumrO2VoCDsiJgg7J6I64ukJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgamVzdC5zZXRUaW1lb3V0KDMwMDAwKTtcclxuXHJcbiAgICBjb25zdCByZW5kZXJSZXN1bHQgPSByZW5kZXIoXHJcbiAgICAgIDxOb3RpZmljYXRpb25Qcm92aWRlcj5cclxuICAgICAgICA8VGVzdENvbXBvbmVudCAvPlxyXG4gICAgICA8L05vdGlmaWNhdGlvblByb3ZpZGVyPlxyXG4gICAgKTtcclxuXHJcbiAgICBhd2FpdCBjaGVja0xvYWRpbmdBbmRHZXRUZXh0cyhyZW5kZXJSZXN1bHQpO1xyXG5cclxuICAgIGNvbnN0IG1hcmtBbGxSZWFkQnV0dG9uID0gcmVuZGVyUmVzdWx0LmdldEJ5VGVzdElkKCdtYXJrLWFsbC1yZWFkJyk7XHJcbiAgICBcclxuICAgIGF3YWl0IGFjdChhc3luYyAoKSA9PiB7XHJcbiAgICAgIGZpcmVFdmVudC5wcmVzcyhtYXJrQWxsUmVhZEJ1dHRvbik7XHJcbiAgICB9KTtcclxuXHJcbiAgICBleHBlY3Qobm90aWZpY2F0aW9uU2VydmljZS5tYXJrQWxsQXNSZWFkKS50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICBleHBlY3Qobm90aWZpY2F0aW9uU2VydmljZS5nZXROb3RpZmljYXRpb25zKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMik7XHJcbiAgfSk7XHJcblxyXG4gIGl0KCfslYzrprzsnYQg7IKt7KCc7ZWgIOyImCDsnojri6QnLCBhc3luYyAoKSA9PiB7XHJcbiAgICBqZXN0LnNldFRpbWVvdXQoMzAwMDApO1xyXG5cclxuICAgIGNvbnN0IHJlbmRlclJlc3VsdCA9IHJlbmRlcihcclxuICAgICAgPE5vdGlmaWNhdGlvblByb3ZpZGVyPlxyXG4gICAgICAgIDxUZXN0Q29tcG9uZW50IC8+XHJcbiAgICAgIDwvTm90aWZpY2F0aW9uUHJvdmlkZXI+XHJcbiAgICApO1xyXG5cclxuICAgIGF3YWl0IGNoZWNrTG9hZGluZ0FuZEdldFRleHRzKHJlbmRlclJlc3VsdCk7XHJcblxyXG4gICAgY29uc3QgZGVsZXRlQnV0dG9uID0gcmVuZGVyUmVzdWx0LmdldEJ5VGVzdElkKCdkZWxldGUtbm90aWZpY2F0aW9uJyk7XHJcbiAgICBcclxuICAgIGF3YWl0IGFjdChhc3luYyAoKSA9PiB7XHJcbiAgICAgIGZpcmVFdmVudC5wcmVzcyhkZWxldGVCdXR0b24pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZXhwZWN0KG5vdGlmaWNhdGlvblNlcnZpY2UuZGVsZXRlTm90aWZpY2F0aW9uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgxKTtcclxuICAgIGV4cGVjdChub3RpZmljYXRpb25TZXJ2aWNlLmdldE5vdGlmaWNhdGlvbnMpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygyKTtcclxuICB9KTtcclxufSk7Il0sIm1hcHBpbmdzIjoiQUFPQUEsV0FBQSxHQUFLQyxJQUFJLCtDQUErQztFQUFBLE9BQU87SUFDN0RDLGdCQUFnQixFQUFFQyxJQUFJLENBQUNDLEVBQUUsQ0FBQyxDQUFDO0lBQzNCQyxVQUFVLEVBQUVGLElBQUksQ0FBQ0MsRUFBRSxDQUFDLENBQUM7SUFDckJFLGFBQWEsRUFBRUgsSUFBSSxDQUFDQyxFQUFFLENBQUMsQ0FBQztJQUN4Qkcsa0JBQWtCLEVBQUVKLElBQUksQ0FBQ0MsRUFBRSxDQUFDO0VBQzlCLENBQUM7QUFBQSxDQUFDLENBQUM7QUFBQyxJQUFBSSxzQkFBQSxHQUFBQyxPQUFBO0FBQUEsSUFBQUMsa0JBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQVhKLElBQUFFLE1BQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFHLE9BQUEsR0FBQUgsT0FBQTtBQUNBLElBQUFJLG9CQUFBLEdBQUFKLE9BQUE7QUFDQSxJQUFBSyxvQkFBQSxHQUFBTixzQkFBQSxDQUFBQyxPQUFBO0FBQTZFLElBQUFNLFdBQUEsR0FBQU4sT0FBQTtBQUFBLFNBQUFULFlBQUE7RUFBQSxJQUFBZ0IsUUFBQSxHQUFBUCxPQUFBO0lBQUFOLElBQUEsR0FBQWEsUUFBQSxDQUFBYixJQUFBO0VBQUFILFdBQUEsWUFBQUEsWUFBQTtJQUFBLE9BQUFHLElBQUE7RUFBQTtFQUFBLE9BQUFBLElBQUE7QUFBQTtBQVU3RSxJQUFN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