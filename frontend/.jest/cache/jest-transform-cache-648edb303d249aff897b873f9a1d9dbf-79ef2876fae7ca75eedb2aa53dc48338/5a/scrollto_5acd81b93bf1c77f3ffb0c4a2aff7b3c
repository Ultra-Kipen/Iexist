ea5ed026c3db947d8d29b7f51341acfa
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.scrollTo = scrollTo;
var _jestMatcherUtils = require("jest-matcher-utils");
var _errors = require("../../helpers/errors");
var _hostComponentNames = require("../../helpers/host-component-names");
var _object = require("../../helpers/object");
var _nativeState = require("../../native-state");
var _eventBuilder = require("../event-builder");
var _utils = require("../utils");
var _utils2 = require("./utils");
function scrollTo(_x, _x2) {
  return _scrollTo.apply(this, arguments);
}
function _scrollTo() {
  _scrollTo = (0, _asyncToGenerator2.default)(function* (element, options) {
    var _options$contentSize$, _options$contentSize, _options$contentSize$2, _options$contentSize2, _nativeState$nativeSt, _dragSteps$at, _ref, _momentumSteps$at;
    if (!(0, _hostComponentNames.isHostScrollView)(element)) {
      throw new _errors.ErrorWithStack(`scrollTo() works only with host "ScrollView" elements. Passed element has type "${element.type}".`, scrollTo);
    }
    ensureScrollViewDirection(element, options);
    (0, _utils.dispatchEvent)(element, 'contentSizeChange', (_options$contentSize$ = (_options$contentSize = options.contentSize) == null ? void 0 : _options$contentSize.width) != null ? _options$contentSize$ : 0, (_options$contentSize$2 = (_options$contentSize2 = options.contentSize) == null ? void 0 : _options$contentSize2.height) != null ? _options$contentSize$2 : 0);
    var initialOffset = (_nativeState$nativeSt = _nativeState.nativeState.contentOffsetForElement.get(element)) != null ? _nativeState$nativeSt : {
      x: 0,
      y: 0
    };
    var dragSteps = (0, _utils2.createScrollSteps)({
      y: options.y,
      x: options.x
    }, initialOffset, _utils2.linearInterpolator);
    yield emitDragScrollEvents(this.config, element, dragSteps, options);
    var momentumStart = (_dragSteps$at = dragSteps.at(-1)) != null ? _dragSteps$at : initialOffset;
    var momentumSteps = (0, _utils2.createScrollSteps)({
      y: options.momentumY,
      x: options.momentumX
    }, momentumStart, _utils2.inertialInterpolator);
    yield emitMomentumScrollEvents(this.config, element, momentumSteps, options);
    var finalOffset = (_ref = (_momentumSteps$at = momentumSteps.at(-1)) != null ? _momentumSteps$at : dragSteps.at(-1)) != null ? _ref : initialOffset;
    _nativeState.nativeState.contentOffsetForElement.set(element, finalOffset);
  });
  return _scrollTo.apply(this, arguments);
}
function emitDragScrollEvents(_x3, _x4, _x5, _x6) {
  return _emitDragScrollEvents.apply(this, arguments);
}
function _emitDragScrollEvents() {
  _emitDragScrollEvents = (0, _asyncToGenerator2.default)(function* (config, element, scrollSteps, scrollOptions) {
    if (scrollSteps.length === 0) {
      return;
    }
    yield (0, _utils.wait)(config);
    (0, _utils.dispatchEvent)(element, 'scrollBeginDrag', _eventBuilder.EventBuilder.ScrollView.scroll(scrollSteps[0], scrollOptions));
    for (var i = 1; i < scrollSteps.length - 1; i += 1) {
      yield (0, _utils.wait)(config);
      (0, _utils.dispatchEvent)(element, 'scroll', _eventBuilder.EventBuilder.ScrollView.scroll(scrollSteps[i], scrollOptions));
    }
    yield (0, _utils.wait)(config);
    var lastStep = scrollSteps.at(-1);
    (0, _utils.dispatchEvent)(element, 'scrollEndDrag', _eventBuilder.EventBuilder.ScrollView.scroll(lastStep, scrollOptions));
  });
  return _emitDragScrollEvents.apply(this, arguments);
}
function emitMomentumScrollEvents(_x7, _x8, _x9, _x10) {
  return _emitMomentumScrollEvents.apply(this, arguments);
}
function _emitMomentumScrollEvents() {
  _emitMomentumScrollEvents = (0, _asyncToGenerator2.default)(function* (config, element, scrollSteps, scrollOptions) {
    if (scrollSteps.length === 0) {
      return;
    }
    yield (0, _utils.wait)(config);
    (0, _utils.dispatchEvent)(element, 'momentumScrollBegin', _eventBuilder.EventBuilder.ScrollView.scroll(scrollSteps[0], scrollOptions));
    for (var i = 1; i < scrollSteps.length; i += 1) {
      yield (0, _utils.wait)(config);
      (0, _utils.dispatchEvent)(element, 'scroll', _eventBuilder.EventBuilder.ScrollView.scroll(scrollSteps[i], scrollOptions));
    }
    yield (0, _utils.wait)(config);
    var lastStep = scrollSteps.at(-1);
    (0, _utils.dispatchEvent)(element, 'momentumScrollEnd', _eventBuilder.EventBuilder.ScrollView.scroll(lastStep, scrollOptions));
  });
  return _emitMomentumScrollEvents.apply(this, arguments);
}
function ensureScrollViewDirection(element, options) {
  var isVerticalScrollView = element.props.horizontal !== true;
  var hasHorizontalScrollOptions = options.x !== undefined || options.momentumX !== undefined;
  if (isVerticalScrollView && hasHorizontalScrollOptions) {
    throw new _errors.ErrorWithStack(`scrollTo() expected only vertical scroll options: "y" and "momentumY" for vertical "ScrollView" element but received ${(0, _jestMatcherUtils.stringify)((0, _object.pick)(options, ['x', 'momentumX']))}`, scrollTo);
  }
  var hasVerticalScrollOptions = options.y !== undefined || options.momentumY !== undefined;
  if (!isVerticalScrollView && hasVerticalScrollOptions) {
    throw new _errors.ErrorWithStack(`scrollTo() expected only horizontal scroll options: "x" and "momentumX" for horizontal "ScrollView" element but received ${(0, _jestMatcherUtils.stringify)((0, _object.pick)(options, ['y', 'momentumY']))}`, scrollTo);
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfamVzdE1hdGNoZXJVdGlscyIsInJlcXVpcmUiLCJfZXJyb3JzIiwiX2hvc3RDb21wb25lbnROYW1lcyIsIl9vYmplY3QiLCJfbmF0aXZlU3RhdGUiLCJfZXZlbnRCdWlsZGVyIiwiX3V0aWxzIiwiX3V0aWxzMiIsInNjcm9sbFRvIiwiX3giLCJfeDIiLCJfc2Nyb2xsVG8iLCJhcHBseSIsImFyZ3VtZW50cyIsIl9hc3luY1RvR2VuZXJhdG9yMiIsImRlZmF1bHQiLCJlbGVtZW50Iiwib3B0aW9ucyIsIl9vcHRpb25zJGNvbnRlbnRTaXplJCIsIl9vcHRpb25zJGNvbnRlbnRTaXplIiwiX29wdGlvbnMkY29udGVudFNpemUkMiIsIl9vcHRpb25zJGNvbnRlbnRTaXplMiIsIl9uYXRpdmVTdGF0ZSRuYXRpdmVTdCIsIl9kcmFnU3RlcHMkYXQiLCJfcmVmIiwiX21vbWVudHVtU3RlcHMkYXQiLCJpc0hvc3RTY3JvbGxWaWV3IiwiRXJyb3JXaXRoU3RhY2siLCJ0eXBlIiwiZW5zdXJlU2Nyb2xsVmlld0RpcmVjdGlvbiIsImRpc3BhdGNoRXZlbnQiLCJjb250ZW50U2l6ZSIsIndpZHRoIiwiaGVpZ2h0IiwiaW5pdGlhbE9mZnNldCIsIm5hdGl2ZVN0YXRlIiwiY29udGVudE9mZnNldEZvckVsZW1lbnQiLCJnZXQiLCJ4IiwieSIsImRyYWdTdGVwcyIsImNyZWF0ZVNjcm9sbFN0ZXBzIiwibGluZWFySW50ZXJwb2xhdG9yIiwiZW1pdERyYWdTY3JvbGxFdmVudHMiLCJjb25maWciLCJtb21lbnR1bVN0YXJ0IiwiYXQiLCJtb21lbnR1bVN0ZXBzIiwibW9tZW50dW1ZIiwibW9tZW50dW1YIiwiaW5lcnRpYWxJbnRlcnBvbGF0b3IiLCJlbWl0TW9tZW50dW1TY3JvbGxFdmVudHMiLCJmaW5hbE9mZnNldCIsInNldCIsIl94MyIsIl94NCIsIl94NSIsIl94NiIsIl9lbWl0RHJhZ1Njcm9sbEV2ZW50cyIsInNjcm9sbFN0ZXBzIiwic2Nyb2xsT3B0aW9ucyIsImxlbmd0aCIsIndhaXQiLCJFdmVudEJ1aWxkZXIiLCJTY3JvbGxWaWV3Iiwic2Nyb2xsIiwiaSIsImxhc3RTdGVwIiwiX3g3IiwiX3g4IiwiX3g5IiwiX3gxMCIsIl9lbWl0TW9tZW50dW1TY3JvbGxFdmVudHMiLCJpc1ZlcnRpY2FsU2Nyb2xsVmlldyIsInByb3BzIiwiaG9yaXpvbnRhbCIsImhhc0hvcml6b250YWxTY3JvbGxPcHRpb25zIiwidW5kZWZpbmVkIiwic3RyaW5naWZ5IiwicGljayIsImhhc1ZlcnRpY2FsU2Nyb2xsT3B0aW9ucyJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy91c2VyLWV2ZW50L3Njcm9sbC9zY3JvbGwtdG8udHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBSZWFjdFRlc3RJbnN0YW5jZSB9IGZyb20gJ3JlYWN0LXRlc3QtcmVuZGVyZXInO1xuaW1wb3J0IHsgc3RyaW5naWZ5IH0gZnJvbSAnamVzdC1tYXRjaGVyLXV0aWxzJztcblxuaW1wb3J0IHsgRXJyb3JXaXRoU3RhY2sgfSBmcm9tICcuLi8uLi9oZWxwZXJzL2Vycm9ycyc7XG5pbXBvcnQgeyBpc0hvc3RTY3JvbGxWaWV3IH0gZnJvbSAnLi4vLi4vaGVscGVycy9ob3N0LWNvbXBvbmVudC1uYW1lcyc7XG5pbXBvcnQgeyBwaWNrIH0gZnJvbSAnLi4vLi4vaGVscGVycy9vYmplY3QnO1xuaW1wb3J0IHsgbmF0aXZlU3RhdGUgfSBmcm9tICcuLi8uLi9uYXRpdmUtc3RhdGUnO1xuaW1wb3J0IHR5cGUgeyBQb2ludCwgU2l6ZSB9IGZyb20gJy4uLy4uL3R5cGVzJztcbmltcG9ydCB7IEV2ZW50QnVpbGRlciB9IGZyb20gJy4uL2V2ZW50LWJ1aWxkZXInO1xuaW1wb3J0IHR5cGUgeyBVc2VyRXZlbnRDb25maWcsIFVzZXJFdmVudEluc3RhbmNlIH0gZnJvbSAnLi4vc2V0dXAnO1xuaW1wb3J0IHsgZGlzcGF0Y2hFdmVudCwgd2FpdCB9IGZyb20gJy4uL3V0aWxzJztcbmltcG9ydCB7IGNyZWF0ZVNjcm9sbFN0ZXBzLCBpbmVydGlhbEludGVycG9sYXRvciwgbGluZWFySW50ZXJwb2xhdG9yIH0gZnJvbSAnLi91dGlscyc7XG5cbmludGVyZmFjZSBDb21tb25TY3JvbGxUb09wdGlvbnMge1xuICBjb250ZW50U2l6ZT86IFNpemU7XG4gIGxheW91dE1lYXN1cmVtZW50PzogU2l6ZTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBWZXJ0aWNhbFNjcm9sbFRvT3B0aW9ucyBleHRlbmRzIENvbW1vblNjcm9sbFRvT3B0aW9ucyB7XG4gIHk6IG51bWJlcjtcbiAgbW9tZW50dW1ZPzogbnVtYmVyO1xuXG4gIC8vIFZlcnRpY2FsIHNjcm9sbCBzaG91bGQgbm90IGNvbnRhaW4gaG9yaXpvbnRhbCBzY3JvbGwgcGFydC5cbiAgeD86IG5ldmVyO1xuICBtb21lbnR1bVg/OiBuZXZlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBIb3Jpem9udGFsU2Nyb2xsVG9PcHRpb25zIGV4dGVuZHMgQ29tbW9uU2Nyb2xsVG9PcHRpb25zIHtcbiAgeDogbnVtYmVyO1xuICBtb21lbnR1bVg/OiBudW1iZXI7XG5cbiAgLy8gSG9yaXpvbnRhbCBzY3JvbGwgc2hvdWxkIG5vdCBjb250YWluIHZlcnRpY2FsIHNjcm9sbCBwYXJ0LlxuICB5PzogbmV2ZXI7XG4gIG1vbWVudHVtWT86IG5ldmVyO1xufVxuXG5leHBvcnQgdHlwZSBTY3JvbGxUb09wdGlvbnMgPSBWZXJ0aWNhbFNjcm9sbFRvT3B0aW9ucyB8IEhvcml6b250YWxTY3JvbGxUb09wdGlvbnM7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzY3JvbGxUbyhcbiAgdGhpczogVXNlckV2ZW50SW5zdGFuY2UsXG4gIGVsZW1lbnQ6IFJlYWN0VGVzdEluc3RhbmNlLFxuICBvcHRpb25zOiBTY3JvbGxUb09wdGlvbnMsXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgaWYgKCFpc0hvc3RTY3JvbGxWaWV3KGVsZW1lbnQpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yV2l0aFN0YWNrKFxuICAgICAgYHNjcm9sbFRvKCkgd29ya3Mgb25seSB3aXRoIGhvc3QgXCJTY3JvbGxWaWV3XCIgZWxlbWVudHMuIFBhc3NlZCBlbGVtZW50IGhhcyB0eXBlIFwiJHtlbGVtZW50LnR5cGV9XCIuYCxcbiAgICAgIHNjcm9sbFRvLFxuICAgICk7XG4gIH1cblxuICBlbnN1cmVTY3JvbGxWaWV3RGlyZWN0aW9uKGVsZW1lbnQsIG9wdGlvbnMpO1xuXG4gIGRpc3BhdGNoRXZlbnQoXG4gICAgZWxlbWVudCxcbiAgICAnY29udGVudFNpemVDaGFuZ2UnLFxuICAgIG9wdGlvbnMuY29udGVudFNpemU/LndpZHRoID8/IDAsXG4gICAgb3B0aW9ucy5jb250ZW50U2l6ZT8uaGVpZ2h0ID8/IDAsXG4gICk7XG5cbiAgY29uc3QgaW5pdGlhbE9mZnNldCA9IG5hdGl2ZVN0YXRlLmNvbnRlbnRPZmZzZXRGb3JFbGVtZW50LmdldChlbGVtZW50KSA/PyB7IHg6IDAsIHk6IDAgfTtcbiAgY29uc3QgZHJhZ1N0ZXBzID0gY3JlYXRlU2Nyb2xsU3RlcHMoXG4gICAgeyB5OiBvcHRpb25zLnksIHg6IG9wdGlvbnMueCB9LFxuICAgIGluaXRpYWxPZmZzZXQsXG4gICAgbGluZWFySW50ZXJwb2xhdG9yLFxuICApO1xuICBhd2FpdCBlbWl0RHJhZ1Njcm9sbEV2ZW50cyh0aGlzLmNvbmZpZywgZWxlbWVudCwgZHJhZ1N0ZXBzLCBvcHRpb25zKTtcblxuICBjb25zdCBtb21lbnR1bVN0YXJ0ID0gZHJhZ1N0ZXBzLmF0KC0xKSA/PyBpbml0aWFsT2Zmc2V0O1xuICBjb25zdCBtb21lbnR1bVN0ZXBzID0gY3JlYXRlU2Nyb2xsU3RlcHMoXG4gICAgeyB5OiBvcHRpb25zLm1vbWVudHVtWSwgeDogb3B0aW9ucy5tb21lbnR1bVggfSxcbiAgICBtb21lbnR1bVN0YXJ0LFxuICAgIGluZXJ0aWFsSW50ZXJwb2xhdG9yLFxuICApO1xuICBhd2FpdCBlbWl0TW9tZW50dW1TY3JvbGxFdmVudHModGhpcy5jb25maWcsIGVsZW1lbnQsIG1vbWVudHVtU3RlcHMsIG9wdGlvbnMpO1xuXG4gIGNvbnN0IGZpbmFsT2Zmc2V0ID0gbW9tZW50dW1TdGVwcy5hdCgtMSkgPz8gZHJhZ1N0ZXBzLmF0KC0xKSA/PyBpbml0aWFsT2Zmc2V0O1xuICBuYXRpdmVTdGF0ZS5jb250ZW50T2Zmc2V0Rm9yRWxlbWVudC5zZXQoZWxlbWVudCwgZmluYWxPZmZzZXQpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBlbWl0RHJhZ1Njcm9sbEV2ZW50cyhcbiAgY29uZmlnOiBVc2VyRXZlbnRDb25maWcsXG4gIGVsZW1lbnQ6IFJlYWN0VGVzdEluc3RhbmNlLFxuICBzY3JvbGxTdGVwczogUG9pbnRbXSxcbiAgc2Nyb2xsT3B0aW9uczogU2Nyb2xsVG9PcHRpb25zLFxuKSB7XG4gIGlmIChzY3JvbGxTdGVwcy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBhd2FpdCB3YWl0KGNvbmZpZyk7XG4gIGRpc3BhdGNoRXZlbnQoXG4gICAgZWxlbWVudCxcbiAgICAnc2Nyb2xsQmVnaW5EcmFnJyxcbiAgICBFdmVudEJ1aWxkZXIuU2Nyb2xsVmlldy5zY3JvbGwoc2Nyb2xsU3RlcHNbMF0sIHNjcm9sbE9wdGlvbnMpLFxuICApO1xuXG4gIC8vIE5vdGU6IGV4cGVyaW1lbnRhbGx5LCBpbiBjYXNlIG9mIGRyYWcgc2Nyb2xsIHRoZSBsYXN0IHNjcm9sbCBzdGVwXG4gIC8vIHdpbGwgbm90IHRyaWdnZXIgYHNjcm9sbGAgZXZlbnQuXG4gIC8vIFNlZTogaHR0cHM6Ly9naXRodWIuY29tL2NhbGxzdGFjay9yZWFjdC1uYXRpdmUtdGVzdGluZy1saWJyYXJ5L3dpa2kvU2Nyb2xsVmlldy1FdmVudHNcbiAgZm9yIChsZXQgaSA9IDE7IGkgPCBzY3JvbGxTdGVwcy5sZW5ndGggLSAxOyBpICs9IDEpIHtcbiAgICBhd2FpdCB3YWl0KGNvbmZpZyk7XG4gICAgZGlzcGF0Y2hFdmVudChlbGVtZW50LCAnc2Nyb2xsJywgRXZlbnRCdWlsZGVyLlNjcm9sbFZpZXcuc2Nyb2xsKHNjcm9sbFN0ZXBzW2ldLCBzY3JvbGxPcHRpb25zKSk7XG4gIH1cblxuICBhd2FpdCB3YWl0KGNvbmZpZyk7XG4gIGNvbnN0IGxhc3RTdGVwID0gc2Nyb2xsU3RlcHMuYXQoLTEpO1xuICBkaXNwYXRjaEV2ZW50KGVsZW1lbnQsICdzY3JvbGxFbmREcmFnJywgRXZlbnRCdWlsZGVyLlNjcm9sbFZpZXcuc2Nyb2xsKGxhc3RTdGVwLCBzY3JvbGxPcHRpb25zKSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGVtaXRNb21lbnR1bVNjcm9sbEV2ZW50cyhcbiAgY29uZmlnOiBVc2VyRXZlbnRDb25maWcsXG4gIGVsZW1lbnQ6IFJlYWN0VGVzdEluc3RhbmNlLFxuICBzY3JvbGxTdGVwczogUG9pbnRbXSxcbiAgc2Nyb2xsT3B0aW9uczogU2Nyb2xsVG9PcHRpb25zLFxuKSB7XG4gIGlmIChzY3JvbGxTdGVwcy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBhd2FpdCB3YWl0KGNvbmZpZyk7XG4gIGRpc3BhdGNoRXZlbnQoXG4gICAgZWxlbWVudCxcbiAgICAnbW9tZW50dW1TY3JvbGxCZWdpbicsXG4gICAgRXZlbnRCdWlsZGVyLlNjcm9sbFZpZXcuc2Nyb2xsKHNjcm9sbFN0ZXBzWzBdLCBzY3JvbGxPcHRpb25zKSxcbiAgKTtcblxuICAvLyBOb3RlOiBleHBlcmltZW50YWxseSwgaW4gY2FzZSBvZiBtb21lbnR1bSBzY3JvbGwgdGhlIGxhc3Qgc2Nyb2xsIHN0ZXBcbiAgLy8gd2lsbCB0cmlnZ2VyIGBzY3JvbGxgIGV2ZW50LlxuICAvLyBTZWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9jYWxsc3RhY2svcmVhY3QtbmF0aXZlLXRlc3RpbmctbGlicmFyeS93aWtpL1Njcm9sbFZpZXctRXZlbnRzXG4gIGZvciAobGV0IGkgPSAxOyBpIDwgc2Nyb2xsU3RlcHMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICBhd2FpdCB3YWl0KGNvbmZpZyk7XG4gICAgZGlzcGF0Y2hFdmVudChlbGVtZW50LCAnc2Nyb2xsJywgRXZlbnRCdWlsZGVyLlNjcm9sbFZpZXcuc2Nyb2xsKHNjcm9sbFN0ZXBzW2ldLCBzY3JvbGxPcHRpb25zKSk7XG4gIH1cblxuICBhd2FpdCB3YWl0KGNvbmZpZyk7XG4gIGNvbnN0IGxhc3RTdGVwID0gc2Nyb2xsU3RlcHMuYXQoLTEpO1xuICBkaXNwYXRjaEV2ZW50KFxuICAgIGVsZW1lbnQsXG4gICAgJ21vbWVudHVtU2Nyb2xsRW5kJyxcbiAgICBFdmVudEJ1aWxkZXIuU2Nyb2xsVmlldy5zY3JvbGwobGFzdFN0ZXAsIHNjcm9sbE9wdGlvbnMpLFxuICApO1xufVxuXG5mdW5jdGlvbiBlbnN1cmVTY3JvbGxWaWV3RGlyZWN0aW9uKGVsZW1lbnQ6IFJlYWN0VGVzdEluc3RhbmNlLCBvcHRpb25zOiBTY3JvbGxUb09wdGlvbnMpIHtcbiAgY29uc3QgaXNWZXJ0aWNhbFNjcm9sbFZpZXcgPSBlbGVtZW50LnByb3BzLmhvcml6b250YWwgIT09IHRydWU7XG5cbiAgY29uc3QgaGFzSG9yaXpvbnRhbFNjcm9sbE9wdGlvbnMgPSBvcHRpb25zLnggIT09IHVuZGVmaW5lZCB8fCBvcHRpb25zLm1vbWVudHVtWCAhPT0gdW5kZWZpbmVkO1xuICBpZiAoaXNWZXJ0aWNhbFNjcm9sbFZpZXcgJiYgaGFzSG9yaXpvbnRhbFNjcm9sbE9wdGlvbnMpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3JXaXRoU3RhY2soXG4gICAgICBgc2Nyb2xsVG8oKSBleHBlY3RlZCBvbmx5IHZlcnRpY2FsIHNjcm9sbCBvcHRpb25zOiBcInlcIiBhbmQgXCJtb21lbnR1bVlcIiBmb3IgdmVydGljYWwgXCJTY3JvbGxWaWV3XCIgZWxlbWVudCBidXQgcmVjZWl2ZWQgJHtzdHJpbmdpZnkoXG4gICAgICAgIHBpY2sob3B0aW9ucywgWyd4JywgJ21vbWVudHVtWCddKSxcbiAgICAgICl9YCxcbiAgICAgIHNjcm9sbFRvLFxuICAgICk7XG4gIH1cblxuICBjb25zdCBoYXNWZXJ0aWNhbFNjcm9sbE9wdGlvbnMgPSBvcHRpb25zLnkgIT09IHVuZGVmaW5lZCB8fCBvcHRpb25zLm1vbWVudHVtWSAhPT0gdW5kZWZpbmVkO1xuICBpZiAoIWlzVmVydGljYWxTY3JvbGxWaWV3ICYmIGhhc1ZlcnRpY2FsU2Nyb2xsT3B0aW9ucykge1xuICAgIHRocm93IG5ldyBFcnJvcldpdGhTdGFjayhcbiAgICAgIGBzY3JvbGxUbygpIGV4cGVjdGVkIG9ubHkgaG9yaXpvbnRhbCBzY3JvbGwgb3B0aW9uczogXCJ4XCIgYW5kIFwibW9tZW50dW1YXCIgZm9yIGhvcml6b250YWwgXCJTY3JvbGxWaWV3XCIgZWxlbWVudCBidXQgcmVjZWl2ZWQgJHtzdHJpbmdpZnkoXG4gICAgICAgIHBpY2sob3B0aW9ucywgWyd5JywgJ21vbWVudHVtWSddKSxcbiAgICAgICl9YCxcbiAgICAgIHNjcm9sbFRvLFxuICAgICk7XG4gIH1cbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFDQSxJQUFBQSxpQkFBQSxHQUFBQyxPQUFBO0FBRUEsSUFBQUMsT0FBQSxHQUFBRCxPQUFBO0FBQ0EsSUFBQUUsbUJBQUEsR0FBQUYsT0FBQTtBQUNBLElBQUFHLE9BQUEsR0FBQUgsT0FBQTtBQUNBLElBQUFJLFlBQUEsR0FBQUosT0FBQTtBQUVBLElBQUFLLGFBQUEsR0FBQUwsT0FBQTtBQUVBLElBQUFNLE1BQUEsR0FBQU4sT0FBQTtBQUNBLElBQUFPLE9BQUEsR0FBQVAsT0FBQTtBQUFBLFNBMkJzQlEsUUFBUUEsQ0FBQUMsRUFBQSxFQUFBQyxHQUFBO0VBQUEsT0FBQUMsU0FBQSxDQUFBQyxLQUFBLE9BQUFDLFNBQUE7QUFBQTtBQUFBLFNBQUFGLFVBQUE7RUFBQUEsU0FBQSxPQUFBRyxrQkFBQSxDQUFBQyxPQUFBLEVBQXZCLFdBRUxDLE9BQTBCLEVBQzFCQyxPQUF3QixFQUNUO0lBQUEsSUFBQUMscUJBQUEsRUFBQUMsb0JBQUEsRUFBQUMsc0JBQUEsRUFBQUMscUJBQUEsRUFBQUMscUJBQUEsRUFBQUMsYUFBQSxFQUFBQyxJQUFBLEVBQUFDLGlCQUFBO0lBQ2YsSUFB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