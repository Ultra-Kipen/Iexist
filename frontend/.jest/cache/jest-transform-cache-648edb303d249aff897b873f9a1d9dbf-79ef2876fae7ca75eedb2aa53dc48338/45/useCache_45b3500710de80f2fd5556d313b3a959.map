{"version":3,"names":["_react","require","_cache","useCache","key","fetchFn","options","arguments","length","undefined","ttl","_options$autoLoad","autoLoad","_options$cacheInstanc","cacheInstance","globalCache","_useState","useState","get","_useState2","_slicedToArray2","default","data","setData","_useState3","_useState4","loading","setLoading","_useState5","_useState6","error","setError","fetchData","useCallback","_asyncToGenerator2","force","result","set","err","Error","String","invalidateCache","delete","useEffect","refetch"],"sources":["useCache.ts"],"sourcesContent":["import { useState, useEffect, useCallback } from 'react';\r\nimport { globalCache, MemoryCache } from '../utils/cache';\r\n\r\ninterface UseCacheOptions {\r\n  /** 캐시 유효 시간 (밀리초) */\r\n  ttl?: number;\r\n  /** 자동 로딩 여부 */\r\n  autoLoad?: boolean;\r\n  /** 특정 캐시 인스턴스 사용 (기본값: globalCache) */\r\n  cacheInstance?: MemoryCache;\r\n}\r\n\r\n/**\r\n * 데이터 캐싱 및 불러오기를 위한 훅\r\n * @param key 캐시 키\r\n * @param fetchFn 데이터 불러오는 함수\r\n * @param options 캐시 옵션\r\n */\r\nexport function useCache<T>(\r\n  key: string,\r\n  fetchFn: () => Promise<T>,\r\n  options: UseCacheOptions = {}\r\n) {\r\n  const {\r\n    ttl,\r\n    autoLoad = true,\r\n    cacheInstance = globalCache\r\n  } = options;\r\n\r\n  const [data, setData] = useState<T | undefined>(cacheInstance.get<T>(key));\r\n  const [loading, setLoading] = useState<boolean>(false);\r\n  const [error, setError] = useState<Error | null>(null);\r\n\r\n  // 데이터 불러오기 함수\r\n  const fetchData = useCallback(async (force = false) => {\r\n    // 캐시에 있고 강제 갱신이 아니면 캐시 데이터 사용\r\n    if (!force && cacheInstance.get<T>(key)) {\r\n      setData(cacheInstance.get<T>(key));\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const result = await fetchFn();\r\n      setData(result);\r\n      cacheInstance.set(key, result, ttl);\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err : new Error(String(err)));\r\n      setData(undefined);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [key, fetchFn, ttl, cacheInstance]);\r\n\r\n  // 캐시 강제 갱신\r\n  const invalidateCache = useCallback(() => {\r\n    cacheInstance.delete(key);\r\n    fetchData(true);\r\n  }, [key, fetchData, cacheInstance]);\r\n\r\n  // 컴포넌트 마운트 시 자동 로딩\r\n  useEffect(() => {\r\n    if (autoLoad) {\r\n      fetchData();\r\n    }\r\n  }, [autoLoad, fetchData]);\r\n\r\n  return {\r\n    data,\r\n    loading,\r\n    error,\r\n    refetch: fetchData,\r\n    invalidateCache\r\n  };\r\n}"],"mappings":"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","ignoreList":[]}